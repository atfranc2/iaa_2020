{"paragraphs":[{"text":"%angular\n\n<h3><b>References:</b></h3>\n<a href=\"http://spark.apache.org/docs/latest/programming-guide.html\" target=\"_blank\">Spark Documentation</a>\n<br><a href=\"http://spark.apache.org/docs/latest/api/python/index.html\" target=\"_blank\">PySpark Documentation</a>\n<br>","user":"anonymous","dateUpdated":"2019-01-04T14:49:12+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<h3><b>References:</b></h3>\n<a href=\"http://spark.apache.org/docs/latest/programming-guide.html\" target=\"_blank\">Spark Documentation</a>\n<br><a href=\"http://spark.apache.org/docs/latest/api/python/index.html\" target=\"_blank\">PySpark Documentation</a>\n<br>"}]},"apps":[],"jobName":"paragraph_1546190694325_1909285059","id":"20170320-124619_794351413","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2019-01-04T14:49:12+0000","dateFinished":"2019-01-04T14:49:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9929"},{"title":"Print Versions","text":"%pyspark\nimport sys\nprint(\"Spark Version:  {}\".format(spark.version))\nprint(\"Python Version: {}\".format(sys.version))\n","user":"anonymous","dateUpdated":"2019-01-04T14:49:16+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark Version:  2.3.2\nPython Version: 3.7.1 (default, Dec 14 2018, 19:28:38) \n[GCC 7.3.0]\n"}]},"apps":[],"jobName":"paragraph_1546190694326_624361405","id":"20180423-124437_961456404","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2019-01-04T14:49:16+0000","dateFinished":"2019-01-04T14:49:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9930"},{"title":"Download and Load Data into HDFS","text":"%sh\n\n# Download Data from Github\nwget https://github.com/hortonworks/data-tutorials/raw/master/tutorials/hdp/advanced-analytics-with-sparkr-in-rstudio/assets/airline_data.zip\n\n# Unzip\nunzip airline_data.zip\n\n# Make HDFS Directory and Load CSV files into HDFS \n# The hadoop lines are commented out because the Docker container will store the files on localhost. If using HDFS, then you can uncomment the lines below.\n\n#hadoop fs -mkdir /tmp/airline_data\n#hadoop fs -put ./airline_data/train_df.csv /tmp/airline_data/.\n#hadoop fs -put ./airline_data/test_df.csv /tmp/airline_data/.\n#hadoop fs -ls /tmp/airline_data\n","user":"anonymous","dateUpdated":"2018-12-30T18:43:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"--2018-12-30 18:39:35--  https://github.com/hortonworks/data-tutorials/raw/master/tutorials/hdp/advanced-analytics-with-sparkr-in-rstudio/assets/airline_data.zip\nResolving github.com (github.com)... 192.30.253.112, 192.30.253.113\nConnecting to github.com (github.com)|192.30.253.112|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://raw.githubusercontent.com/hortonworks/data-tutorials/master/tutorials/hdp/advanced-analytics-with-sparkr-in-rstudio/assets/airline_data.zip [following]\n--2018-12-30 18:39:35--  https://raw.githubusercontent.com/hortonworks/data-tutorials/master/tutorials/hdp/advanced-analytics-with-sparkr-in-rstudio/assets/airline_data.zip\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 25613885 (24M) [application/zip]\nSaving to: 'airline_data.zip.3'\n\n     0K .......... .......... .......... .......... ..........  0% 1.80M 14s\n    50K .......... .......... .......... .......... ..........  0% 4.28M 10s\n   100K .......... .......... .......... .......... ..........  0% 4.67M 8s\n   150K .......... .......... .......... .......... ..........  0% 4.72M 7s\n   200K .......... .......... .......... .......... ..........  0% 5.34M 7s\n   250K .......... .......... .......... .......... ..........  1% 5.25M 6s\n   300K .......... .......... .......... .......... ..........  1% 5.95M 6s\n   350K .......... .......... .......... .......... ..........  1% 5.39M 6s\n   400K .......... .......... .......... .......... ..........  1% 4.70M 6s\n   450K .......... .......... .......... .......... ..........  1% 6.08M 6s\n   500K .......... .......... .......... .......... ..........  2% 5.88M 5s\n   550K .......... .......... .......... .......... ..........  2% 7.38M 5s\n   600K .......... .......... .......... .......... ..........  2% 5.94M 5s\n   650K .......... .......... .......... .......... ..........  2% 6.14M 5s\n   700K .......... .......... .......... .......... ..........  2% 7.55M 5s\n   750K .......... .......... .......... .......... ..........  3% 7.50M 5s\n   800K .......... .......... .......... .......... ..........  3% 5.68M 5s\n   850K .......... .......... .......... .......... ..........  3% 7.05M 5s\n   900K .......... .......... .......... .......... ..........  3% 9.75M 5s\n   950K .......... .......... .......... .......... ..........  3% 7.04M 4s\n  1000K .......... .......... .......... .......... ..........  4% 8.95M 4s\n  1050K .......... .......... .......... .......... ..........  4% 7.59M 4s\n  1100K .......... .......... .......... .......... ..........  4% 9.50M 4s\n  1150K .......... .......... .......... .......... ..........  4% 8.01M 4s\n  1200K .......... .......... .......... .......... ..........  4% 7.17M 4s\n  1250K .......... .......... .......... .......... ..........  5% 9.69M 4s\n  1300K .......... .......... .......... .......... ..........  5% 8.43M 4s\n  1350K .......... .......... .......... .......... ..........  5% 9.59M 4s\n  1400K .......... .......... .......... .......... ..........  5% 11.7M 4s\n  1450K .......... .......... .......... .......... ..........  5% 8.69M 4s\n  1500K .......... .......... .......... .......... ..........  6% 9.44M 4s\n  1550K .......... .......... .......... .......... ..........  6% 14.9M 4s\n  1600K .......... .......... .......... .......... ..........  6% 7.33M 4s\n  1650K .......... .......... .......... .......... ..........  6% 10.1M 4s\n  1700K .......... .......... .......... .......... ..........  6% 12.5M 4s\n  1750K .......... .......... .......... .......... ..........  7% 10.2M 3s\n  1800K .......... .......... .......... .......... ..........  7% 11.0M 3s\n  1850K .......... .......... .......... .......... ..........  7% 13.2M 3s\n  1900K .......... .......... .......... .......... ..........  7% 12.8M 3s\n  1950K .......... .......... .......... .......... ..........  7% 10.5M 3s\n  2000K .......... .......... .......... .......... ..........  8% 9.76M 3s\n  2050K .......... .......... .......... .......... ..........  8% 17.1M 3s\n  2100K .......... .......... .......... .......... ..........  8% 9.48M 3s\n  2150K .......... .......... .......... .......... ..........  8% 10.4M 3s\n  2200K .......... .......... .......... .......... ..........  8% 16.4M 3s\n  2250K .......... .......... .......... .......... ..........  9% 14.6M 3s\n  2300K .......... .......... .......... .......... ..........  9% 10.3M 3s\n  2350K .......... .......... .......... .......... ..........  9% 20.1M 3s\n  2400K .......... .......... .......... .......... ..........  9% 12.3M 3s\n  2450K .......... .......... .......... .......... ..........  9% 8.92M 3s\n  2500K .......... .......... .......... .......... .......... 10% 19.5M 3s\n  2550K .......... .......... .......... .......... .......... 10% 13.9M 3s\n  2600K .......... .......... .......... .......... .......... 10% 15.2M 3s\n  2650K .......... .......... .......... .......... .......... 10% 13.0M 3s\n  2700K .......... .......... .......... .......... .......... 10% 19.9M 3s\n  2750K .......... .......... .......... .......... .......... 11% 11.9M 3s\n  2800K .......... .......... .......... .......... .......... 11% 9.05M 3s\n  2850K .......... .......... .......... .......... .......... 11% 33.4M 3s\n  2900K .......... .......... .......... .......... .......... 11% 15.5M 3s\n  2950K .......... .......... .......... .......... .......... 11% 18.2M 3s\n  3000K .......... .......... .......... .......... .......... 12% 10.5M 3s\n  3050K .......... .......... .......... .......... .......... 12% 31.2M 3s\n  3100K .......... .......... .......... .......... .......... 12% 15.7M 3s\n  3150K .......... .......... .......... .......... .......... 12% 19.3M 3s\n  3200K .......... .......... .......... .......... .......... 12% 8.97M 3s\n  3250K .......... .......... .......... .......... .......... 13% 18.4M 2s\n  3300K .......... .......... .......... .......... .......... 13% 24.3M 2s\n  3350K .......... .......... .......... .......... .......... 13% 17.3M 2s\n  3400K .......... .......... .......... .......... .......... 13% 13.4M 2s\n  3450K .......... .......... .......... .......... .......... 13% 23.4M 2s\n  3500K .......... .......... .......... .......... .......... 14% 18.4M 2s\n  3550K .......... .......... .......... .......... .......... 14% 19.1M 2s\n  3600K .......... .......... .......... .......... .......... 14% 13.1M 2s\n  3650K .......... .......... .......... .......... .......... 14% 15.8M 2s\n  3700K .......... .......... .......... .......... .......... 14% 19.2M 2s\n  3750K .......... .......... .......... .......... .......... 15% 33.8M 2s\n  3800K .......... .......... .......... .......... .......... 15% 24.0M 2s\n  3850K .......... .......... .......... .......... .......... 15% 11.9M 2s\n  3900K .......... .......... .......... .......... .......... 15% 26.7M 2s\n  3950K .......... .......... .......... .......... .......... 15% 18.6M 2s\n  4000K .......... .......... .......... .......... .......... 16% 20.3M 2s\n  4050K .......... .......... .......... .......... .......... 16% 25.0M 2s\n  4100K .......... .......... .......... .......... .......... 16% 13.8M 2s\n  4150K .......... .......... .......... .......... .......... 16% 17.5M 2s\n  4200K .......... .......... .......... .......... .......... 16% 21.7M 2s\n  4250K .......... .......... .......... .......... .......... 17% 31.3M 2s\n  4300K .......... .......... .......... .......... .......... 17% 21.2M 2s\n  4350K .......... .......... .......... .......... .......... 17% 17.1M 2s\n  4400K .......... .......... .......... .......... .......... 17% 16.2M 2s\n  4450K .......... .......... .......... .......... .......... 17% 23.0M 2s\n  4500K .......... .......... .......... .......... .......... 18% 30.8M 2s\n  4550K .......... .......... .......... .......... .......... 18% 19.7M 2s\n  4600K .......... .......... .......... .......... .......... 18% 37.0M 2s\n  4650K .......... .......... .......... .......... .......... 18% 20.9M 2s\n  4700K .......... .......... .......... .......... .......... 18% 13.8M 2s\n  4750K .......... .......... .......... .......... .......... 19% 22.1M 2s\n  4800K .......... .......... .......... .......... .......... 19% 18.6M 2s\n  4850K .......... .......... .......... .......... .......... 19% 57.4M 2s\n  4900K .......... .......... .......... .......... .......... 19% 16.3M 2s\n  4950K .......... .......... .......... .......... .......... 19% 16.7M 2s\n  5000K .......... .......... .......... .......... .......... 20% 26.1M 2s\n  5050K .......... .......... .......... .......... .......... 20% 48.7M 2s\n  5100K .......... .......... .......... .......... .......... 20% 20.2M 2s\n  5150K .......... .......... .......... .......... .......... 20% 37.2M 2s\n  5200K .......... .......... .......... .......... .......... 20% 18.1M 2s\n  5250K .......... .......... .......... .......... .......... 21% 15.1M 2s\n  5300K .......... .......... .......... .......... .......... 21% 26.2M 2s\n  5350K .......... .......... .......... .......... .......... 21% 30.3M 2s\n  5400K .......... .......... .......... .......... .......... 21% 34.3M 2s\n  5450K .......... .......... .......... .......... .......... 21% 17.1M 2s\n  5500K .......... .......... .......... .......... .......... 22% 43.4M 2s\n  5550K .......... .......... .......... .......... .......... 22% 15.6M 2s\n  5600K .......... .......... .......... .......... .......... 22% 29.2M 2s\n  5650K .......... .......... .......... .......... .......... 22% 37.4M 2s\n  5700K .......... .......... .......... .......... .......... 22% 28.8M 2s\n  5750K .......... .......... .......... .......... .......... 23% 41.6M 2s\n  5800K .......... .......... .......... .......... .......... 23% 16.7M 2s\n  5850K .......... .......... .......... .......... .......... 23% 45.3M 2s\n  5900K .......... .......... .......... .......... .......... 23% 18.9M 2s\n  5950K .......... .......... .......... .......... .......... 23% 29.9M 2s\n  6000K .......... .......... .......... .......... .......... 24% 29.0M 2s\n  6050K .......... .......... .......... .......... .......... 24% 27.0M 2s\n  6100K .......... .......... .......... .......... .......... 24% 24.3M 2s\n  6150K .......... .......... .......... .......... .......... 24% 28.2M 2s\n  6200K .......... .......... .......... .......... .......... 24% 17.4M 2s\n  6250K .......... .......... .......... .......... .......... 25% 39.8M 2s\n  6300K .......... .......... .......... .......... .......... 25% 42.8M 2s\n  6350K .......... .......... .......... .......... .......... 25% 25.5M 2s\n  6400K .......... .......... .......... .......... .......... 25% 27.1M 1s\n  6450K .......... .......... .......... .......... .......... 25% 32.5M 1s\n  6500K .......... .......... .......... .......... .......... 26% 11.5M 1s\n  6550K .......... .......... .......... .......... .......... 26%  104M 1s\n  6600K .......... .......... .......... .......... .......... 26% 30.3M 1s\n  6650K .......... .......... .......... .......... .......... 26% 52.5M 1s\n  6700K .......... .......... .......... .......... .......... 26% 29.1M 1s\n  6750K .......... .......... .......... .......... .......... 27% 44.2M 1s\n  6800K .......... .......... .......... .......... .......... 27% 27.0M 1s\n  6850K .......... .......... .......... .......... .......... 27% 29.8M 1s\n  6900K .......... .......... .......... .......... .......... 27% 17.1M 1s\n  6950K .......... .......... .......... .......... .......... 27% 24.9M 1s\n  7000K .......... .......... .......... .......... .......... 28% 51.3M 1s\n  7050K .......... .......... .......... .......... .......... 28% 46.1M 1s\n  7100K .......... .......... .......... .......... .......... 28% 55.6M 1s\n  7150K .......... .......... .......... .......... .......... 28% 29.8M 1s\n  7200K .......... .......... .......... .......... .......... 28% 20.8M 1s\n  7250K .......... .......... .......... .......... .......... 29% 16.5M 1s\n  7300K .......... .......... .......... .......... .......... 29% 90.8M 1s\n  7350K .......... .......... .......... .......... .......... 29% 29.1M 1s\n  7400K .......... .......... .......... .......... .......... 29% 53.8M 1s\n  7450K .......... .......... .......... .......... .......... 29% 27.5M 1s\n  7500K .......... .......... .......... .......... .......... 30% 66.2M 1s\n  7550K .......... .......... .......... .......... .......... 30% 38.8M 1s\n  7600K .......... .......... .......... .......... .......... 30% 21.0M 1s\n  7650K .......... .......... .......... .......... .......... 30% 17.5M 1s\n  7700K .......... .......... .......... .......... .......... 30% 34.4M 1s\n  7750K .......... .......... .......... .......... .......... 31% 81.9M 1s\n  7800K .......... .......... .......... .......... .......... 31% 63.4M 1s\n  7850K .......... .......... .......... .......... .......... 31% 29.8M 1s\n  7900K .......... .......... .......... .......... .......... 31% 36.3M 1s\n  7950K .......... .......... .......... .......... .......... 31% 40.7M 1s\n  8000K .......... .......... .......... .......... .......... 32% 22.9M 1s\n  8050K .......... .......... .......... .......... .......... 32% 18.3M 1s\n  8100K .......... .......... .......... .......... .......... 32% 56.2M 1s\n  8150K .......... .......... .......... .......... .......... 32% 34.7M 1s\n  8200K .......... .......... .......... .......... .......... 32% 76.8M 1s\n  8250K .......... .......... .......... .......... .......... 33% 33.4M 1s\n  8300K .......... .......... .......... .......... .......... 33% 79.1M 1s\n  8350K .......... .......... .......... .......... .......... 33% 24.4M 1s\n  8400K .......... .......... .......... .......... .......... 33% 48.4M 1s\n  8450K .......... .......... .......... .......... .......... 33% 35.0M 1s\n  8500K .......... .......... .......... .......... .......... 34% 18.1M 1s\n  8550K .......... .......... .......... .......... .......... 34% 54.1M 1s\n  8600K .......... .......... .......... .......... .......... 34% 36.9M 1s\n  8650K .......... .......... .......... .......... .......... 34% 29.8M 1s\n  8700K .......... .......... .......... .......... .......... 34% 39.8M 1s\n  8750K .......... .......... .......... .......... .......... 35%  112M 1s\n  8800K .......... .......... .......... .......... .......... 35% 31.8M 1s\n  8850K .......... .......... .......... .......... .......... 35% 37.5M 1s\n  8900K .......... .......... .......... .......... .......... 35% 46.5M 1s\n  8950K .......... .......... .......... .......... .......... 35% 47.4M 1s\n  9000K .......... .......... .......... .......... .......... 36% 18.7M 1s\n  9050K .......... .......... .......... .......... .......... 36% 68.9M 1s\n  9100K .......... .......... .......... .......... .......... 36% 21.7M 1s\n  9150K .......... .......... .......... .......... .......... 36% 99.9M 1s\n  9200K .......... .......... .......... .......... .......... 36% 36.4M 1s\n  9250K .......... .......... .......... .......... .......... 37% 50.7M 1s\n  9300K .......... .......... .......... .......... .......... 37% 41.7M 1s\n  9350K .......... .......... .......... .......... .......... 37% 36.2M 1s\n  9400K .......... .......... .......... .......... .......... 37% 67.7M 1s\n  9450K .......... .......... .......... .......... .......... 37% 74.1M 1s\n  9500K .......... .......... .......... .......... .......... 38% 18.2M 1s\n  9550K .......... .......... .......... .......... .......... 38% 46.2M 1s\n  9600K .......... .......... .......... .......... .......... 38% 28.7M 1s\n  9650K .......... .......... .......... .......... .......... 38%  147M 1s\n  9700K .......... .......... .......... .......... .......... 38% 33.7M 1s\n  9750K .......... .......... .......... .......... .......... 39% 71.3M 1s\n  9800K .......... .......... .......... .......... .......... 39% 35.2M 1s\n  9850K .......... .......... .......... .......... .......... 39% 63.8M 1s\n  9900K .......... .......... .......... .......... .......... 39% 60.3M 1s\n  9950K .......... .......... .......... .......... .......... 39% 46.5M 1s\n 10000K .......... .......... .......... .......... .......... 40% 18.1M 1s\n 10050K .......... .......... .......... .......... .......... 40% 46.8M 1s\n 10100K .......... .......... .......... .......... .......... 40% 82.5M 1s\n 10150K .......... .......... .......... .......... .......... 40% 36.3M 1s\n 10200K .......... .......... .......... .......... .......... 40% 45.0M 1s\n 10250K .......... .......... .......... .......... .......... 41% 37.5M 1s\n 10300K .......... .......... .......... .......... .......... 41%  109M 1s\n 10350K .......... .......... .......... .......... .......... 41% 45.9M 1s\n 10400K .......... .......... .......... .......... .......... 41% 33.7M 1s\n 10450K .......... .......... .......... .......... .......... 41% 54.3M 1s\n 10500K .......... .......... .......... .......... .......... 42% 17.8M 1s\n 10550K .......... .......... .......... .......... .......... 42%  144M 1s\n 10600K .......... .......... .......... .......... .......... 42% 42.5M 1s\n 10650K .......... .......... .......... .......... .......... 42% 33.4M 1s\n 10700K .......... .......... .......... .......... .......... 42% 82.9M 1s\n 10750K .......... .......... .......... .......... .......... 43% 53.6M 1s\n 10800K .......... .......... .......... .......... .......... 43% 42.3M 1s\n 10850K .......... .......... .......... .......... .......... 43%  100M 1s\n 10900K .......... .......... .......... .......... .......... 43% 39.0M 1s\n 10950K .......... .......... .......... .......... .......... 43% 38.8M 1s\n 11000K .......... .......... .......... .......... .......... 44%  160M 1s\n 11050K .......... .......... .......... .......... .......... 44% 68.0M 1s\n 11100K .......... .......... .......... .......... .......... 44% 19.4M 1s\n 11150K .......... .......... .......... .......... .......... 44% 42.5M 1s\n 11200K .......... .......... .......... .......... .......... 44% 30.8M 1s\n 11250K .......... .......... .......... .......... .......... 45% 79.7M 1s\n 11300K .......... .......... .......... .......... .......... 45%  166M 1s\n 11350K .......... .......... .......... .......... .......... 45% 45.7M 1s\n 11400K .......... .......... .......... .......... .......... 45% 42.6M 1s\n 11450K .......... .......... .......... .......... .......... 45% 38.1M 1s\n 11500K .......... .......... .......... .......... .......... 46%  200M 1s\n 11550K .......... .......... .......... .......... .......... 46% 47.7M 1s\n 11600K .......... .......... .......... .......... .......... 46% 44.5M 1s\n 11650K .......... .......... .......... .......... .......... 46% 19.7M 1s\n 11700K .......... .......... .......... .......... .......... 46% 53.3M 1s\n 11750K .......... .......... .......... .......... .......... 47%  160M 1s\n 11800K .......... .......... .......... .......... .......... 47% 30.0M 1s\n 11850K .......... .......... .......... .......... .......... 47% 77.3M 1s\n 11900K .......... .......... .......... .......... .......... 47% 54.5M 1s\n 11950K .......... .......... .......... .......... .......... 47% 66.3M 1s\n 12000K .......... .......... .......... .......... .......... 48% 47.5M 1s\n 12050K .......... .......... .......... .......... .......... 48% 39.8M 1s\n 12100K .......... .......... .......... .......... .......... 48% 95.3M 1s\n 12150K .......... .......... .......... .......... .......... 48% 55.4M 1s\n 12200K .......... .......... .......... .......... .......... 48%  173M 1s\n 12250K .......... .......... .......... .......... .......... 49% 44.4M 1s\n 12300K .......... .......... .......... .......... .......... 49% 21.6M 1s\n 12350K .......... .......... .......... .......... .......... 49% 68.5M 1s\n 12400K .......... .......... .......... .......... .......... 49% 29.3M 1s\n 12450K .......... .......... .......... .......... .......... 49%  167M 1s\n 12500K .......... .......... .......... .......... .......... 50% 94.0M 1s\n 12550K .......... .......... .......... .......... .......... 50% 52.7M 1s\n 12600K .......... .......... .......... .......... .......... 50% 33.8M 1s\n 12650K .......... .......... .......... .......... .......... 50%  143M 1s\n 12700K .......... .......... .......... .......... .......... 50% 43.8M 1s\n 12750K .......... .......... .......... .......... .......... 51%  124M 1s\n 12800K .......... .......... .......... .......... .......... 51% 43.0M 1s\n 12850K .......... .......... .......... .......... .......... 51% 53.7M 1s\n 12900K .......... .......... .......... .......... .......... 51%  177M 1s\n 12950K .......... .......... .......... .......... .......... 51% 21.5M 1s\n 13000K .......... .......... .......... .......... .......... 52% 63.8M 1s\n 13050K .......... .......... .......... .......... .......... 52% 26.9M 1s\n 13100K .......... .......... .......... .......... .......... 52%  186M 1s\n 13150K .......... .......... .......... .......... .......... 52%  107M 1s\n 13200K .......... .......... .......... .......... .......... 52% 44.4M 1s\n 13250K .......... .......... .......... .......... .......... 53% 41.3M 1s\n 13300K .......... .......... .......... .......... .......... 53% 38.2M 1s\n 13350K .......... .......... .......... .......... .......... 53%  105M 1s\n 13400K .......... .......... .......... .......... .......... 53%  144M 1s\n 13450K .......... .......... .......... .......... .......... 53% 58.7M 1s\n 13500K .......... .......... .......... .......... .......... 54% 40.2M 1s\n 13550K .......... .......... .......... .......... .......... 54%  110M 1s\n 13600K .......... .......... .......... .......... .......... 54% 32.8M 1s\n 13650K .......... .......... .......... .......... .......... 54%  109M 1s\n 13700K .......... .......... .......... .......... .......... 54% 66.7M 1s\n 13750K .......... .......... .......... .......... .......... 55% 26.0M 1s\n 13800K .......... .......... .......... .......... .......... 55%  102M 1s\n 13850K .......... .......... .......... .......... .......... 55%  167M 1s\n 13900K .......... .......... .......... .......... .......... 55% 46.3M 1s\n 13950K .......... .......... .......... .......... .......... 55% 37.6M 1s\n 14000K .......... .......... .......... .......... .......... 56% 43.5M 1s\n 14050K .......... .......... .......... .......... .......... 56%  107M 1s\n 14100K .......... .......... .......... .......... .......... 56% 82.1M 1s\n 14150K .......... .......... .......... .......... .......... 56% 99.4M 1s\n 14200K .......... .......... .......... .......... .......... 56% 39.7M 1s\n 14250K .......... .......... .......... .......... .......... 57%  111M 1s\n 14300K .......... .......... .......... .......... .......... 57%  155M 1s\n 14350K .......... .......... .......... .......... .......... 57% 34.5M 1s\n 14400K .......... .......... .......... .......... .......... 57% 56.2M 1s\n 14450K .......... .......... .......... .......... .......... 57% 22.9M 1s\n 14500K .......... .......... .......... .......... .......... 58%  111M 1s\n 14550K .......... .......... .......... .......... .......... 58%  190M 1s\n 14600K .......... .......... .......... .......... .......... 58% 62.2M 1s\n 14650K .......... .......... .......... .......... .......... 58% 32.0M 0s\n 14700K .......... .......... .......... .......... .......... 58% 48.2M 0s\n 14750K .......... .......... .......... .......... .......... 59%  125M 0s\n 14800K .......... .......... .......... .......... .......... 59%  108M 0s\n 14850K .......... .......... .......... .......... .......... 59% 70.9M 0s\n 14900K .......... .......... .......... .......... .......... 59% 65.6M 0s\n 14950K .......... .......... .......... .......... .......... 59% 69.5M 0s\n 15000K .......... .......... .......... .......... .......... 60%  161M 0s\n 15050K .......... .......... .......... .......... .......... 60% 61.7M 0s\n 15100K .......... .......... .......... .......... .......... 60% 57.7M 0s\n 15150K .......... .......... .......... .......... .......... 60% 47.2M 0s\n 15200K .......... .......... .......... .......... .......... 60% 24.9M 0s\n 15250K .......... .......... .......... .......... .......... 61%  159M 0s\n 15300K .......... .......... .......... .......... .......... 61%  107M 0s\n 15350K .......... .......... .......... .......... .......... 61% 62.4M 0s\n 15400K .......... .......... .......... .......... .......... 61% 34.5M 0s\n 15450K .......... .......... .......... .......... .......... 61% 43.3M 0s\n 15500K .......... .......... .......... .......... .......... 62%  157M 0s\n 15550K .......... .......... .......... .......... .......... 62% 93.2M 0s\n 15600K .......... .......... .......... .......... .......... 62% 83.1M 0s\n 15650K .......... .......... .......... .......... .......... 62% 59.4M 0s\n 15700K .......... .......... .......... .......... .......... 62% 64.8M 0s\n 15750K .......... .......... .......... .......... .......... 63%  156M 0s\n 15800K .......... .......... .......... .......... .......... 63% 56.5M 0s\n 15850K .......... .......... .......... .......... .......... 63% 63.6M 0s\n 15900K .......... .......... .......... .......... .......... 63% 47.5M 0s\n 15950K .......... .......... .......... .......... .......... 63%  172M 0s\n 16000K .......... .......... .......... .......... .......... 64% 27.0M 0s\n 16050K .......... .......... .......... .......... .......... 64%  104M 0s\n 16100K .......... .......... .......... .......... .......... 64% 75.2M 0s\n 16150K .......... .......... .......... .......... .......... 64% 31.9M 0s\n 16200K .......... .......... .......... .......... .......... 64%  103M 0s\n 16250K .......... .......... .......... .......... .......... 65%  211M 0s\n 16300K .......... .......... .......... .......... .......... 65% 66.2M 0s\n 16350K .......... .......... .......... .......... .......... 65% 77.0M 0s\n 16400K .......... .......... .......... .......... .......... 65% 69.5M 0s\n 16450K .......... .......... .......... .......... .......... 65%  173M 0s\n 16500K .......... .......... .......... .......... .......... 66% 61.1M 0s\n 16550K .......... .......... .......... .......... .......... 66% 73.5M 0s\n 16600K .......... .......... .......... .......... .......... 66% 60.6M 0s\n 16650K .......... .......... .......... .......... .......... 66%  205M 0s\n 16700K .......... .......... .......... .......... .......... 66% 66.8M 0s\n 16750K .......... .......... .......... .......... .......... 67% 43.7M 0s\n 16800K .......... .......... .......... .......... .......... 67% 26.0M 0s\n 16850K .......... .......... .......... .......... .......... 67%  109M 0s\n 16900K .......... .......... .......... .......... .......... 67%  189M 0s\n 16950K .......... .......... .......... .......... .......... 67% 75.5M 0s\n 17000K .......... .......... .......... .......... .......... 68% 30.0M 0s\n 17050K .......... .......... .......... .......... .......... 68%  110M 0s\n 17100K .......... .......... .......... .......... .......... 68%  196M 0s\n 17150K .......... .......... .......... .......... .......... 68% 76.0M 0s\n 17200K .......... .......... .......... .......... .......... 68% 70.3M 0s\n 17250K .......... .......... .......... .......... .......... 69% 84.6M 0s\n 17300K .......... .......... .......... .......... .......... 69% 55.7M 0s\n 17350K .......... .......... .......... .......... .......... 69%  170M 0s\n 17400K .......... .......... .......... .......... .......... 69% 73.2M 0s\n 17450K .......... .......... .......... .......... .......... 69% 68.0M 0s\n 17500K .......... .......... .......... .......... .......... 70% 64.3M 0s\n 17550K .......... .......... .......... .......... .......... 70%  114M 0s\n 17600K .......... .......... .......... .......... .......... 70% 61.2M 0s\n 17650K .......... .......... .......... .......... .......... 70%  180M 0s\n 17700K .......... .......... .......... .......... .......... 70% 25.7M 0s\n 17750K .......... .......... .......... .......... .......... 71%  152M 0s\n 17800K .......... .......... .......... .......... .......... 71% 99.5M 0s\n 17850K .......... .......... .......... .......... .......... 71%  158M 0s\n 17900K .......... .......... .......... .......... .......... 71% 29.3M 0s\n 17950K .......... .......... .......... .......... .......... 71%  150M 0s\n 18000K .......... .......... .......... .......... .......... 72% 58.7M 0s\n 18050K .......... .......... .......... .......... .......... 72%  116M 0s\n 18100K .......... .......... .......... .......... .......... 72%  127M 0s\n 18150K .......... .......... .......... .......... .......... 72% 83.9M 0s\n 18200K .......... .......... .......... .......... .......... 72% 51.8M 0s\n 18250K .......... .......... .......... .......... .......... 73% 72.6M 0s\n 18300K .......... .......... .......... .......... .......... 73%  161M 0s\n 18350K .......... .......... .......... .......... .......... 73% 63.6M 0s\n 18400K .......... .......... .......... .......... .......... 73% 99.8M 0s\n 18450K .......... .......... .......... .......... .......... 73% 72.1M 0s\n 18500K .......... .......... .......... .......... .......... 74% 65.0M 0s\n 18550K .......... .......... .......... .......... .......... 74%  156M 0s\n 18600K .......... .......... .......... .......... .......... 74% 25.7M 0s\n 18650K .......... .......... .......... .......... .......... 74%  108M 0s\n 18700K .......... .......... .......... .......... .......... 74%  179M 0s\n 18750K .......... .......... .......... .......... .......... 75%  114M 0s\n 18800K .......... .......... .......... .......... .......... 75% 34.8M 0s\n 18850K .......... .......... .......... .......... .......... 75%  105M 0s\n 18900K .......... .......... .......... .......... .......... 75% 95.2M 0s\n 18950K .......... .......... .......... .......... .......... 75% 95.5M 0s\n 19000K .......... .......... .......... .......... .......... 76%  164M 0s\n 19050K .......... .......... .......... .......... .......... 76% 67.3M 0s\n 19100K .......... .......... .......... .......... .......... 76% 99.6M 0s\n 19150K .......... .......... .......... .......... .......... 76% 67.8M 0s\n 19200K .......... .......... .......... .......... .......... 76% 85.3M 0s\n 19250K .......... .......... .......... .......... .......... 77%  155M 0s\n 19300K .......... .......... .......... .......... .......... 77% 69.7M 0s\n 19350K .......... .......... .......... .......... .......... 77%  103M 0s\n 19400K .......... .......... .......... .......... .......... 77% 70.8M 0s\n 19450K .......... .......... .......... .......... .......... 77%  207M 0s\n 19500K .......... .......... .......... .......... .......... 78% 60.7M 0s\n 19550K .......... .......... .......... .......... .......... 78% 26.1M 0s\n 19600K .......... .......... .......... .......... .......... 78% 77.6M 0s\n 19650K .......... .......... .......... .......... .......... 78%  108M 0s\n 19700K .......... .......... .......... .......... .......... 78% 41.3M 0s\n 19750K .......... .......... .......... .......... .......... 79%  149M 0s\n 19800K .......... .......... .......... .......... .......... 79% 89.8M 0s\n 19850K .......... .......... .......... .......... .......... 79% 95.9M 0s\n 19900K .......... .......... .......... .......... .......... 79% 96.2M 0s\n 19950K .......... .......... .......... .......... .......... 79%  191M 0s\n 20000K .......... .......... .......... .......... .......... 80% 75.9M 0s\n 20050K .......... .......... .......... .......... .......... 80% 82.4M 0s\n 20100K .......... .......... .......... .......... .......... 80% 74.5M 0s\n 20150K .......... .......... .......... .......... .......... 80% 86.3M 0s\n 20200K .......... .......... .......... .......... .......... 80%  138M 0s\n 20250K .......... .......... .......... .......... .......... 81% 98.7M 0s\n 20300K .......... .......... .......... .......... .......... 81% 89.0M 0s\n 20350K .......... .......... .......... .......... .......... 81% 91.3M 0s\n 20400K .......... .......... .......... .......... .......... 81% 81.9M 0s\n 20450K .......... .......... .......... .......... .......... 81%  176M 0s\n 20500K .......... .......... .......... .......... .......... 82% 93.1M 0s\n 20550K .......... .......... .......... .......... .......... 82% 27.1M 0s\n 20600K .......... .......... .......... .......... .......... 82%  102M 0s\n 20650K .......... .......... .......... .......... .......... 82%  196M 0s\n 20700K .......... .......... .......... .......... .......... 82% 77.9M 0s\n 20750K .......... .......... .......... .......... .......... 83% 40.2M 0s\n 20800K .......... .......... .......... .......... .......... 83%  102M 0s\n 20850K .......... .......... .......... .......... .......... 83%  106M 0s\n 20900K .......... .......... .......... .......... .......... 83%  174M 0s\n 20950K .......... .......... .......... .......... .......... 83% 84.5M 0s\n 21000K .......... .......... .......... .......... .......... 84% 80.8M 0s\n 21050K .......... .......... .......... .......... .......... 84% 87.5M 0s\n 21100K .......... .......... .......... .......... .......... 84%  192M 0s\n 21150K .......... .......... .......... .......... .......... 84% 68.5M 0s\n 21200K .......... .......... .......... .......... .......... 84% 74.7M 0s\n 21250K .......... .......... .......... .......... .......... 85%  116M 0s\n 21300K .......... .......... .......... .......... .......... 85% 93.5M 0s\n 21350K .......... .......... .......... .......... .......... 85%  163M 0s\n 21400K .......... .......... .......... .......... .......... 85% 87.3M 0s\n 21450K .......... .......... .......... .......... .......... 85% 68.7M 0s\n 21500K .......... .......... .......... .......... .......... 86%  116M 0s\n 21550K .......... .......... .......... .......... .......... 86%  184M 0s\n 21600K .......... .......... .......... .......... .......... 86%  162M 0s\n 21650K .......... .......... .......... .......... .......... 86% 32.7M 0s\n 21700K .......... .......... .......... .......... .......... 86%  110M 0s\n 21750K .......... .......... .......... .......... .......... 87% 69.0M 0s\n 21800K .......... .......... .......... .......... .......... 87% 39.9M 0s\n 21850K .......... .......... .......... .......... .......... 87%  152M 0s\n 21900K .......... .......... .......... .......... .......... 87%  117M 0s\n 21950K .......... .......... .......... .......... .......... 87%  168M 0s\n 22000K .......... .......... .......... .......... .......... 88% 95.3M 0s\n 22050K .......... .......... .......... .......... .......... 88% 62.3M 0s\n 22100K .......... .......... .......... .......... .......... 88%  155M 0s\n 22150K .......... .......... .......... .......... .......... 88%  100M 0s\n 22200K .......... .......... .......... .......... .......... 88% 81.9M 0s\n 22250K .......... .......... .......... .......... .......... 89% 75.0M 0s\n 22300K .......... .......... .......... .......... .......... 89%  155M 0s\n 22350K .......... .......... .......... .......... .......... 89%  116M 0s\n 22400K .......... .......... .......... .......... .......... 89% 98.8M 0s\n 22450K .......... .......... .......... .......... .......... 89% 73.2M 0s\n 22500K .......... .......... .......... .......... .......... 90% 65.8M 0s\n 22550K .......... .......... .......... .......... .......... 90%  164M 0s\n 22600K .......... .......... .......... .......... .......... 90%  133M 0s\n 22650K .......... .......... .......... .......... .......... 90%  146M 0s\n 22700K .......... .......... .......... .......... .......... 90% 32.8M 0s\n 22750K .......... .......... .......... .......... .......... 91%  148M 0s\n 22800K .......... .......... .......... .......... .......... 91%  175M 0s\n 22850K .......... .......... .......... .......... .......... 91% 82.5M 0s\n 22900K .......... .......... .......... .......... .......... 91%  155M 0s\n 22950K .......... .......... .......... .......... .......... 91% 44.7M 0s\n 23000K .......... .......... .......... .......... .......... 92%  139M 0s\n 23050K .......... .......... .......... .......... .......... 92%  193M 0s\n 23100K .......... .......... .......... .......... .......... 92%  119M 0s\n 23150K .......... .......... .......... .......... .......... 92%  116M 0s\n 23200K .......... .......... .......... .......... .......... 92% 50.9M 0s\n 23250K .......... .......... .......... .......... .......... 93%  181M 0s\n 23300K .......... .......... .......... .......... .......... 93%  108M 0s\n 23350K .......... .......... .......... .......... .......... 93%  111M 0s\n 23400K .......... .......... .......... .......... .......... 93% 63.5M 0s\n 23450K .......... .......... .......... .......... .......... 93%  166M 0s\n 23500K .......... .......... .......... .......... .......... 94%  115M 0s\n 23550K .......... .......... .......... .......... .......... 94% 84.0M 0s\n 23600K .......... .......... .......... .......... .......... 94% 99.8M 0s\n 23650K .......... .......... .......... .......... .......... 94% 57.9M 0s\n 23700K .......... .......... .......... .......... .......... 94%  150M 0s\n 23750K .......... .......... .......... .......... .......... 95%  174M 0s\n 23800K .......... .......... .......... .......... .......... 95%  133M 0s\n 23850K .......... .......... .......... .......... .......... 95% 30.9M 0s\n 23900K .......... .......... .......... .......... .......... 95%  177M 0s\n 23950K .......... .......... .......... .......... .......... 95%  183M 0s\n 24000K .......... .......... .......... .......... .......... 96% 85.4M 0s\n 24050K .......... .......... .......... .......... .......... 96%  144M 0s\n 24100K .......... .......... .......... .......... .......... 96% 48.5M 0s\n 24150K .......... .......... .......... .......... .......... 96%  179M 0s\n 24200K .......... .......... .......... .......... .......... 96%  171M 0s\n 24250K .......... .......... .......... .......... .......... 97%  113M 0s\n 24300K .......... .......... .......... .......... .......... 97% 92.9M 0s\n 24350K .......... .......... .......... .......... .......... 97%  114M 0s\n 24400K .......... .......... .......... .......... .......... 97% 94.2M 0s\n 24450K .......... .......... .......... .......... .......... 97%  179M 0s\n 24500K .......... .......... .......... .......... .......... 98%  132M 0s\n 24550K .......... .......... .......... .......... .......... 98% 78.8M 0s\n 24600K .......... .......... .......... .......... .......... 98% 68.0M 0s\n 24650K .......... .......... .......... .......... .......... 98%  157M 0s\n 24700K .......... .......... .......... .......... .......... 98%  188M 0s\n 24750K .......... .......... .......... .......... .......... 99% 73.7M 0s\n 24800K .......... .......... .......... .......... .......... 99%  101M 0s\n 24850K .......... .......... .......... .......... .......... 99% 69.7M 0s\n 24900K .......... .......... .......... .......... .......... 99%  146M 0s\n 24950K .......... .......... .......... .......... .......... 99%  108M 0s\n 25000K .......... ...                                        100%  145M=0.8s\n\n2018-12-30 18:39:36 (29.1 MB/s) - 'airline_data.zip.3' saved [25613885/25613885]\n\nArchive:  airline_data.zip\nreplace airline_data/test_df.csv? [y]es, [n]o, [A]ll, [N]one, [r]ename:  NULL\n(EOF or read error, treating as \"[N]one\" ...)\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1546190694326_-349955150","id":"20180423-125153_1122800085","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:39:35+0000","dateFinished":"2018-12-30T18:39:36+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:9931"},{"title":"Load Python Libraries","text":"%pyspark\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import monotonically_increasing_id, col, expr, when, concat, lit, isnan\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.regression import GeneralizedLinearRegression\nfrom pyspark.ml.classification import RandomForestClassifier, LogisticRegression\nfrom pyspark.ml.feature import VectorIndexer, VectorAssembler, StringIndexer, OneHotEncoder\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator, RegressionEvaluator, BinaryClassificationEvaluator\nfrom pyspark.ml import Pipeline","user":"anonymous","dateUpdated":"2018-12-30T18:39:51+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546190694327_800598627","id":"20170323-141100_836862574","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:39:51+0000","dateFinished":"2018-12-30T18:39:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9932"},{"title":"Load Data","text":"%pyspark\n\n# Use (uncomment) the line below if data is coming from HDFS.\n#train_df = spark.read.load(\"hdfs:///tmp/airline_data/train_df.csv\", \"csv\", delimiter=\",\", inferSchema=True, header=True)\ntrain_df  = spark.read.load(\"file:///airline_data/train_df.csv\", \"csv\", delimiter=\",\", inferSchema=True, header=True)\n\ntrain_df.createOrReplaceTempView(\"train_df\")\n","user":"anonymous","dateUpdated":"2018-12-30T18:43:47+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546190694327_-1234369458","id":"20170320-023442_13943793","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:43:47+0000","dateFinished":"2018-12-30T18:43:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9933"},{"title":"What does my dataset look like?  (Can also look at Correlation)","text":"%sql\nselect * from train_df LIMIT 100","user":"anonymous","dateUpdated":"2018-12-30T18:43:56+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"vehicle_id","index":0,"aggr":"sum"}],"values":[{"name":"tip_amount","index":12,"aggr":"sum"},{"name":"vehicle_id","index":0,"aggr":"count"}],"groups":[],"scatter":{"xAxis":{"name":"trip_distance","index":4,"aggr":"sum"},"yAxis":{"name":"fare_amount","index":9,"aggr":"sum"},"size":{"name":"tip_amount","index":12,"aggr":"sum"}},"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"YEAR":"string","MONTH":"string","DAY_OF_MONTH":"string","DAY_OF_WEEK":"string","CARRIER":"string","FL_NUM":"string","ORIGIN":"string","DEST":"string","DEP_TIME":"string","DEP_DELAY":"string","ARR_TIME":"string","ARR_DELAY":"string","CANCELLED":"string","CANCELLATION_CODE":"string","AIR_TIME":"string","DISTANCE":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"YEAR\tMONTH\tDAY_OF_MONTH\tDAY_OF_WEEK\tCARRIER\tFL_NUM\tORIGIN\tDEST\tDEP_TIME\tDEP_DELAY\tARR_TIME\tARR_DELAY\tCANCELLED\tCANCELLATION_CODE\tAIR_TIME\tDISTANCE\n2015\t1\t1\t4\tAA\t1\tJFK\tLAX\t855\t-5\t1237\t7\t0\tnull\t378\t2475\n2015\t1\t2\t5\tAA\t1\tJFK\tLAX\t850\t-10\t1211\t-19\t0\tnull\t357\t2475\n2015\t1\t3\t6\tAA\t1\tJFK\tLAX\t853\t-7\t1151\t-39\t0\tnull\t330\t2475\n2015\t1\t4\t7\tAA\t1\tJFK\tLAX\t853\t-7\t1218\t-12\t0\tnull\t352\t2475\n2015\t1\t5\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1222\t-8\t0\tnull\t338\t2475\n2015\t1\t6\t2\tAA\t1\tJFK\tLAX\t856\t-4\t1300\t25\t0\tnull\t335\t2475\n2015\t1\t7\t3\tAA\t1\tJFK\tLAX\t859\t-1\t1221\t-14\t0\tnull\t341\t2475\n2015\t1\t8\t4\tAA\t1\tJFK\tLAX\t856\t-4\t1158\t-37\t0\tnull\t333\t2475\n2015\t1\t9\t5\tAA\t1\tJFK\tLAX\t901\t1\t1241\t6\t0\tnull\t353\t2475\n2015\t1\t10\t6\tAA\t1\tJFK\tLAX\t903\t3\t1235\t0\t0\tnull\t345\t2475\n2015\t1\t11\t7\tAA\t1\tJFK\tLAX\t854\t-6\t1159\t-36\t0\tnull\t337\t2475\n2015\t1\t12\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1230\t-5\t0\tnull\t354\t2475\n2015\t1\t13\t2\tAA\t1\tJFK\tLAX\t854\t-6\t1155\t-40\t0\tnull\t336\t2475\n2015\t1\t14\t3\tAA\t1\tJFK\tLAX\t856\t-4\t1126\t-69\t0\tnull\t302\t2475\n2015\t1\t15\t4\tAA\t1\tJFK\tLAX\t852\t-8\t1231\t-4\t0\tnull\t320\t2475\n2015\t1\t16\t5\tAA\t1\tJFK\tLAX\t900\t0\t1206\t-29\t0\tnull\t321\t2475\n2015\t1\t17\t6\tAA\t1\tJFK\tLAX\t852\t-8\t1157\t-38\t0\tnull\t343\t2475\n2015\t1\t18\t7\tAA\t1\tJFK\tLAX\t916\t16\t1236\t1\t0\tnull\t340\t2475\n2015\t1\t19\t1\tAA\t1\tJFK\tLAX\t854\t-6\t1218\t-17\t0\tnull\t359\t2475\n2015\t1\t20\t2\tAA\t1\tJFK\tLAX\t853\t-7\t1203\t-32\t0\tnull\t349\t2475\n2015\t1\t21\t3\tAA\t1\tJFK\tLAX\t853\t-7\t1142\t-53\t0\tnull\t327\t2475\n2015\t1\t22\t4\tAA\t1\tJFK\tLAX\t852\t-8\t1150\t-45\t0\tnull\t324\t2475\n2015\t1\t23\t5\tAA\t1\tJFK\tLAX\t854\t-6\t1146\t-49\t0\tnull\t328\t2475\n2015\t1\t24\t6\tAA\t1\tJFK\tLAX\t1043\t103\t1354\t79\t0\tnull\t323\t2475\n2015\t1\t25\t7\tAA\t1\tJFK\tLAX\t903\t3\t1145\t-50\t0\tnull\t308\t2475\n2015\t1\t26\t1\tAA\t1\tJFK\tLAX\t854\t-6\t1240\t5\t0\tnull\t337\t2475\n2015\t1\t27\t2\tAA\t1\tJFK\tLAX\tNA\tNA\tNA\tNA\t1\tB\tNA\t2475\n2015\t1\t28\t3\tAA\t1\tJFK\tLAX\tNA\tNA\tNA\tNA\t1\tB\tNA\t2475\n2015\t1\t29\t4\tAA\t1\tJFK\tLAX\t855\t-5\t1217\t-18\t0\tnull\t349\t2475\n2015\t1\t30\t5\tAA\t1\tJFK\tLAX\t858\t-2\t1242\t7\t0\tnull\t352\t2475\n2015\t1\t31\t6\tAA\t1\tJFK\tLAX\t854\t-6\t1222\t-13\t0\tnull\t347\t2475\n2015\t1\t1\t4\tAA\t2\tLAX\tJFK\t856\t-4\t1651\t-44\t0\tnull\t271\t2475\n2015\t1\t2\t5\tAA\t2\tLAX\tJFK\t854\t-6\t1727\t-8\t0\tnull\t294\t2475\n2015\t1\t3\t6\tAA\t2\tLAX\tJFK\t922\t22\t1759\t24\t0\tnull\t297\t2475\n2015\t1\t4\t7\tAA\t2\tLAX\tJFK\t1141\t161\t2005\t150\t0\tnull\t291\t2475\n2015\t1\t5\t1\tAA\t2\tLAX\tJFK\t852\t-8\t1720\t-15\t0\tnull\t293\t2475\n2015\t1\t6\t2\tAA\t2\tLAX\tJFK\t858\t-2\t1711\t-18\t0\tnull\t278\t2475\n2015\t1\t7\t3\tAA\t2\tLAX\tJFK\t850\t-10\t1710\t-19\t0\tnull\t298\t2475\n2015\t1\t8\t4\tAA\t2\tLAX\tJFK\t853\t-7\t1709\t-20\t0\tnull\t285\t2475\n2015\t1\t9\t5\tAA\t2\tLAX\tJFK\t852\t-8\t1711\t-18\t0\tnull\t293\t2475\n2015\t1\t10\t6\tAA\t2\tLAX\tJFK\t858\t-2\t1722\t-7\t0\tnull\t284\t2475\n2015\t1\t11\t7\tAA\t2\tLAX\tJFK\t853\t-7\t1723\t-6\t0\tnull\t302\t2475\n2015\t1\t12\t1\tAA\t2\tLAX\tJFK\t900\t0\t1738\t9\t0\tnull\t295\t2475\n2015\t1\t13\t2\tAA\t2\tLAX\tJFK\t857\t-3\t1720\t-9\t0\tnull\t293\t2475\n2015\t1\t14\t3\tAA\t2\tLAX\tJFK\t854\t-6\t1722\t-7\t0\tnull\t301\t2475\n2015\t1\t15\t4\tAA\t2\tLAX\tJFK\t857\t-3\t1731\t2\t0\tnull\t303\t2475\n2015\t1\t16\t5\tAA\t2\tLAX\tJFK\t853\t-7\t1726\t-3\t0\tnull\t306\t2475\n2015\t1\t17\t6\tAA\t2\tLAX\tJFK\t854\t-6\t1719\t-10\t0\tnull\t300\t2475\n2015\t1\t18\t7\tAA\t2\tLAX\tJFK\t856\t-4\t1729\t0\t0\tnull\t313\t2475\n2015\t1\t19\t1\tAA\t2\tLAX\tJFK\t856\t-4\t1709\t-20\t0\tnull\t284\t2475\n2015\t1\t20\t2\tAA\t2\tLAX\tJFK\t857\t-3\t1710\t-19\t0\tnull\t284\t2475\n2015\t1\t21\t3\tAA\t2\tLAX\tJFK\t852\t-8\t1659\t-30\t0\tnull\t280\t2475\n2015\t1\t22\t4\tAA\t2\tLAX\tJFK\t855\t-5\t1710\t-19\t0\tnull\t290\t2475\n2015\t1\t23\t5\tAA\t2\tLAX\tJFK\t852\t-8\t1714\t-15\t0\tnull\t294\t2475\n2015\t1\t24\t6\tAA\t2\tLAX\tJFK\t851\t-9\t1740\t11\t0\tnull\t323\t2475\n2015\t1\t25\t7\tAA\t2\tLAX\tJFK\t856\t-4\t1736\t7\t0\tnull\t313\t2475\n2015\t1\t26\t1\tAA\t2\tLAX\tJFK\tNA\tNA\tNA\tNA\t1\tB\tNA\t2475\n2015\t1\t27\t2\tAA\t2\tLAX\tJFK\tNA\tNA\tNA\tNA\t1\tB\tNA\t2475\n2015\t1\t28\t3\tAA\t2\tLAX\tJFK\t940\t40\t1757\t28\t0\tnull\t285\t2475\n2015\t1\t29\t4\tAA\t2\tLAX\tJFK\t854\t-6\t1714\t-15\t0\tnull\t285\t2475\n2015\t1\t30\t5\tAA\t2\tLAX\tJFK\t853\t-7\t1722\t-7\t0\tnull\t285\t2475\n2015\t1\t31\t6\tAA\t2\tLAX\tJFK\t854\t-6\t1706\t-23\t0\tnull\t277\t2475\n2015\t1\t1\t4\tAA\t3\tJFK\tLAX\t1226\t-4\t1548\t-2\t0\tnull\t358\t2475\n2015\t1\t2\t5\tAA\t3\tJFK\tLAX\t1219\t-11\t1520\t-30\t0\tnull\t339\t2475\n2015\t1\t3\t6\tAA\t3\tJFK\tLAX\t1227\t-3\t1536\t-14\t0\tnull\t333\t2475\n2015\t1\t4\t7\tAA\t3\tJFK\tLAX\t1226\t-4\t1546\t-4\t0\tnull\t347\t2475\n2015\t1\t5\t1\tAA\t3\tJFK\tLAX\t1224\t-6\t1554\t4\t0\tnull\t349\t2475\n2015\t1\t6\t2\tAA\t3\tJFK\tLAX\t1227\t-3\t1647\t52\t0\tnull\t370\t2475\n2015\t1\t7\t3\tAA\t3\tJFK\tLAX\t1225\t-5\t1531\t-24\t0\tnull\t341\t2475\n2015\t1\t8\t4\tAA\t3\tJFK\tLAX\t1228\t-2\t1547\t-8\t0\tnull\t358\t2475\n2015\t1\t9\t5\tAA\t3\tJFK\tLAX\t1230\t0\t1613\t18\t0\tnull\t346\t2475\n2015\t1\t10\t6\tAA\t3\tJFK\tLAX\t1226\t-4\t1553\t-2\t0\tnull\t353\t2475\n2015\t1\t11\t7\tAA\t3\tJFK\tLAX\t1233\t3\t1535\t-20\t0\tnull\t341\t2475\n2015\t1\t12\t1\tAA\t3\tJFK\tLAX\t1226\t-4\t1605\t10\t0\tnull\t368\t2475\n2015\t1\t13\t2\tAA\t3\tJFK\tLAX\t1223\t-7\t1525\t-30\t0\tnull\t335\t2475\n2015\t1\t14\t3\tAA\t3\tJFK\tLAX\t1231\t1\t1503\t-52\t0\tnull\t306\t2475\n2015\t1\t15\t4\tAA\t3\tJFK\tLAX\t1223\t-7\t1449\t-66\t0\tnull\t306\t2475\n2015\t1\t16\t5\tAA\t3\tJFK\tLAX\t1226\t-4\t1509\t-46\t0\tnull\t322\t2475\n2015\t1\t17\t6\tAA\t3\tJFK\tLAX\t1228\t-2\t1526\t-29\t0\tnull\t334\t2475\n2015\t1\t18\t7\tAA\t3\tJFK\tLAX\t1228\t-2\t1528\t-27\t0\tnull\t336\t2475\n2015\t1\t19\t1\tAA\t3\tJFK\tLAX\t1221\t-9\t1544\t-11\t0\tnull\t360\t2475\n2015\t1\t20\t2\tAA\t3\tJFK\tLAX\t1230\t0\t1618\t23\t0\tnull\t381\t2475\n2015\t1\t21\t3\tAA\t3\tJFK\tLAX\t1221\t-9\t1512\t-43\t0\tnull\t328\t2475\n2015\t1\t22\t4\tAA\t3\tJFK\tLAX\t1224\t-6\t1500\t-55\t0\tnull\t308\t2475\n2015\t1\t23\t5\tAA\t3\tJFK\tLAX\t1224\t-6\t1508\t-47\t0\tnull\t325\t2475\n2015\t1\t24\t6\tAA\t3\tJFK\tLAX\t1226\t-4\t1529\t-26\t0\tnull\t318\t2475\n2015\t1\t25\t7\tAA\t3\tJFK\tLAX\t1221\t-9\t1501\t-54\t0\tnull\t317\t2475\n2015\t1\t26\t1\tAA\t3\tJFK\tLAX\t1223\t-7\t1527\t-28\t0\tnull\t317\t2475\n2015\t1\t27\t2\tAA\t3\tJFK\tLAX\tNA\tNA\tNA\tNA\t1\tB\tNA\t2475\n2015\t1\t28\t3\tAA\t3\tJFK\tLAX\tNA\tNA\tNA\tNA\t1\tB\tNA\t2475\n2015\t1\t29\t4\tAA\t3\tJFK\tLAX\t1227\t-3\t1542\t-13\t0\tnull\t342\t2475\n2015\t1\t30\t5\tAA\t3\tJFK\tLAX\t1259\t29\t1618\t23\t0\tnull\t346\t2475\n2015\t1\t31\t6\tAA\t3\tJFK\tLAX\t1222\t-8\t1531\t-24\t0\tnull\t335\t2475\n2015\t1\t1\t4\tAA\t4\tLAX\tJFK\t1214\t-6\t2033\t-17\t0\tnull\t284\t2475\n2015\t1\t2\t5\tAA\t4\tLAX\tJFK\t1215\t-5\t2035\t-15\t0\tnull\t290\t2475\n2015\t1\t3\t6\tAA\t4\tLAX\tJFK\t1259\t39\t2146\t56\t0\tnull\t300\t2475\n2015\t1\t4\t7\tAA\t4\tLAX\tJFK\t1332\t72\t2158\t68\t0\tnull\t297\t2475\n2015\t1\t5\t1\tAA\t4\tLAX\tJFK\t1243\t23\t2043\t-7\t0\tnull\t282\t2475\n2015\t1\t6\t2\tAA\t4\tLAX\tJFK\t1247\t17\t2116\t10\t0\tnull\t294\t2475\n2015\t1\t7\t3\tAA\t4\tLAX\tJFK\t1352\t82\t2209\t63\t0\tnull\t299\t2475\n"}]},"apps":[],"jobName":"paragraph_1546190694327_-43484154","id":"20170320-110237_163337070","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:43:55+0000","dateFinished":"2018-12-30T18:43:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9934"},{"title":"Create \"Weekend\" Flag","text":"%pyspark\n\ntrain_df = train_df.withColumn(\"WEEKEND\", when((train_df.DAY_OF_WEEK == 5) | (train_df.DAY_OF_WEEK == 6) | (train_df.DAY_OF_WEEK == 7), 1).otherwise(0))\ntrain_df.show()\n","user":"anonymous","dateUpdated":"2018-12-30T18:44:01+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|\n|2015|    1|          11|          7|     AA|     1|   JFK| LAX|     854|       -6|    1159|      -36|        0|             null|     337|    2475|      1|\n|2015|    1|          12|          1|     AA|     1|   JFK| LAX|     853|       -7|    1230|       -5|        0|             null|     354|    2475|      0|\n|2015|    1|          13|          2|     AA|     1|   JFK| LAX|     854|       -6|    1155|      -40|        0|             null|     336|    2475|      0|\n|2015|    1|          14|          3|     AA|     1|   JFK| LAX|     856|       -4|    1126|      -69|        0|             null|     302|    2475|      0|\n|2015|    1|          15|          4|     AA|     1|   JFK| LAX|     852|       -8|    1231|       -4|        0|             null|     320|    2475|      0|\n|2015|    1|          16|          5|     AA|     1|   JFK| LAX|     900|        0|    1206|      -29|        0|             null|     321|    2475|      1|\n|2015|    1|          17|          6|     AA|     1|   JFK| LAX|     852|       -8|    1157|      -38|        0|             null|     343|    2475|      1|\n|2015|    1|          18|          7|     AA|     1|   JFK| LAX|     916|       16|    1236|        1|        0|             null|     340|    2475|      1|\n|2015|    1|          19|          1|     AA|     1|   JFK| LAX|     854|       -6|    1218|      -17|        0|             null|     359|    2475|      0|\n|2015|    1|          20|          2|     AA|     1|   JFK| LAX|     853|       -7|    1203|      -32|        0|             null|     349|    2475|      0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546190694328_-5362811","id":"20180423-133137_95400914","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:44:01+0000","dateFinished":"2018-12-30T18:44:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9935"},{"title":"Extract Departure Hour","text":"%pyspark\n\ntrain_df = train_df.withColumn(\"DEP_HOUR\", (train_df.DEP_TIME/float(100)).cast('int') )\ntrain_df.show(20)","user":"anonymous","dateUpdated":"2018-12-30T18:44:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|\n|2015|    1|          11|          7|     AA|     1|   JFK| LAX|     854|       -6|    1159|      -36|        0|             null|     337|    2475|      1|       8|\n|2015|    1|          12|          1|     AA|     1|   JFK| LAX|     853|       -7|    1230|       -5|        0|             null|     354|    2475|      0|       8|\n|2015|    1|          13|          2|     AA|     1|   JFK| LAX|     854|       -6|    1155|      -40|        0|             null|     336|    2475|      0|       8|\n|2015|    1|          14|          3|     AA|     1|   JFK| LAX|     856|       -4|    1126|      -69|        0|             null|     302|    2475|      0|       8|\n|2015|    1|          15|          4|     AA|     1|   JFK| LAX|     852|       -8|    1231|       -4|        0|             null|     320|    2475|      0|       8|\n|2015|    1|          16|          5|     AA|     1|   JFK| LAX|     900|        0|    1206|      -29|        0|             null|     321|    2475|      1|       9|\n|2015|    1|          17|          6|     AA|     1|   JFK| LAX|     852|       -8|    1157|      -38|        0|             null|     343|    2475|      1|       8|\n|2015|    1|          18|          7|     AA|     1|   JFK| LAX|     916|       16|    1236|        1|        0|             null|     340|    2475|      1|       9|\n|2015|    1|          19|          1|     AA|     1|   JFK| LAX|     854|       -6|    1218|      -17|        0|             null|     359|    2475|      0|       8|\n|2015|    1|          20|          2|     AA|     1|   JFK| LAX|     853|       -7|    1203|      -32|        0|             null|     349|    2475|      0|       8|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546190694328_-987735965","id":"20180423-133532_746879178","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:44:15+0000","dateFinished":"2018-12-30T18:44:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9936"},{"title":"Create DELAY_LABELED","text":"%pyspark\n\n# DELAY_LABELED: Has a value of 1 if the arrival delay(ARR_DELAY) is greater than 15 minutes and 0 if ARR_DELAY is less than or equal to 15 minutes.\n\ntrain_df = train_df.withColumn(\"DELAY_LABELED\", when( (train_df.ARR_DELAY > 15), 1).otherwise(0))\ntrain_df.show(10)","user":"anonymous","dateUpdated":"2018-12-30T18:44:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|DELAY_LABELED|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|            0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|            0|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|            0|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|            0|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|            0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|            1|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|            0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|            0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|            0|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|            0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546190694328_2024784853","id":"20180423-133531_307339763","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:44:20+0000","dateFinished":"2018-12-30T18:44:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9937"},{"title":"Filter out Cancelled Flights","text":"%pyspark\n\n'''\nWe will keep only those flight records where it did not get cancelled. \nIn the next statement, we are keeping those records where the value of CANCELLED is equal to 0. (a value of 1 == CANCELLED)\n'''\n\ntrain_df = train_df.filter(train_df.CANCELLED == 0)\ntrain_df.show(10)\n","user":"anonymous","dateUpdated":"2018-12-30T18:44:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|DELAY_LABELED|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|            0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|            0|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|            0|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|            0|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|            0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|            1|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|            0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|            0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|            0|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|            0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546190694328_-605128767","id":"20180423-135248_410945782","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:44:24+0000","dateFinished":"2018-12-30T18:44:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9938"},{"title":"Remove ARR_DELAY NAs","text":"%pyspark\n\n'''\nAfter looking a dataset for a while, you will see that there are lot of NA values in ARR_DELAY column.\nWe should keep only those where we have valid readings of ARR_DELAY (remove NAs).\n'''\n\nprint(\"Initial Train_DF Count: \" + str(train_df.count()))\ntrain_df = train_df.filter( train_df.ARR_DELAY != \"NA\" )\nprint(\"New Train_DF Count:     \" + str(train_df.count()))\ntrain_df.show(10)\n","user":"anonymous","dateUpdated":"2018-12-30T18:44:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Initial Train_DF Count: 1033485\nNew Train_DF Count:     1030606\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|DELAY_LABELED|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|            0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|            0|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|            0|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|            0|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|            0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|            1|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|            0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|            0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|            0|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|            0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546190694329_1104382478","id":"20180423-135715_359504819","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:44:29+0000","dateFinished":"2018-12-30T18:44:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9939"},{"title":"What is the Schema?  How many records?","text":"%pyspark\n\nprint('\\r\\nTotal Records: ' + str(train_df.count()) + '\\r\\n\\r\\n')\nfor i in train_df.dtypes: print(i)\n","user":"anonymous","dateUpdated":"2018-12-30T18:45:05+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\r\nTotal Records: 1030606\r\n\r\n\n('YEAR', 'int')\n('MONTH', 'int')\n('DAY_OF_MONTH', 'int')\n('DAY_OF_WEEK', 'int')\n('CARRIER', 'string')\n('FL_NUM', 'int')\n('ORIGIN', 'string')\n('DEST', 'string')\n('DEP_TIME', 'string')\n('DEP_DELAY', 'string')\n('ARR_TIME', 'string')\n('ARR_DELAY', 'string')\n('CANCELLED', 'int')\n('CANCELLATION_CODE', 'string')\n('AIR_TIME', 'string')\n('DISTANCE', 'int')\n('WEEKEND', 'int')\n('DEP_HOUR', 'int')\n('DELAY_LABELED', 'int')\n"}]},"apps":[],"jobName":"paragraph_1546190694329_488274815","id":"20170320-105240_996898077","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:05+0000","dateFinished":"2018-12-30T18:45:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9940"},{"title":"Convert from String to Int","text":"%pyspark\n\n'''\nWe should convert the type of ARR_DELAY and DEP_DELAY from string to integer so that we can perform mathematical operations on that.\n'''\n\ntrain_df = train_df.withColumn(\"ARR_DELAY\",     col(\"ARR_DELAY\").cast(\"int\")) \\\n                   .withColumn(\"DEP_DELAY\",     col(\"DEP_DELAY\").cast(\"int\")) \\\n                   .withColumn(\"AIR_TIME\",      col(\"AIR_TIME\").cast(\"int\"))  \\\n                   .withColumn(\"DAY_OF_WEEK\",   col(\"DAY_OF_WEEK\").cast(\"string\"))\n \ntrain_df.dtypes\ntrain_df.createOrReplaceTempView(\"train_df\")\n","user":"anonymous","dateUpdated":"2018-12-30T18:45:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546190694329_-1229919228","id":"20180423-143302_702987549","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:12+0000","dateFinished":"2018-12-30T18:45:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9941"},{"title":"EXPLORATORY DATA ANALYSIS - Find the number of delays (and on-time flights) by Airline Carrier","text":"%sql\n\nSELECT CARRIER, DELAY_LABELED, count(*) as count\n    FROM train_df \n    GROUP BY CARRIER, DELAY_LABELED \n    LIMIT 20","user":"anonymous","dateUpdated":"2019-01-04T14:54:48+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"runOnSelectionChange":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"CARRIER","index":0,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}],"groups":[{"name":"DELAY_LABELED","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"vehicle_id","index":0,"aggr":"sum"},"yAxis":{"name":"avg_distance","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{"OrderBy":"avg_distance"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CARRIER\tDELAY_LABELED\tcount\nUA\t0\t189131\nDL\t0\t385200\nUA\t1\t55749\nAA\t0\t269059\nAA\t1\t67234\nDL\t1\t64233\n"}]},"apps":[],"jobName":"paragraph_1546190694329_-1429301903","id":"20170320-105033_610898887","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:18+0000","dateFinished":"2018-12-30T18:45:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9942"},{"title":"EXPLORATORY ANALYSIS - Create Delay DataFrame (% of on-time vs delayed flights)","text":"%pyspark\n\n'''\nWe create a new dataframe called delay which will have two columns, DELAY_LABELED and the count of it. \nBasically it will have a count of delayed flights and ontime flights. We will be using aggregate where we group the \ndataframe by DELAY_LABELED and calculating the count using n().\n'''\n\ndelay = train_df.groupBy( train_df.DELAY_LABELED ).count() \\\n                .withColumn(\"STATUS\", when( col(\"DELAY_LABELED\") == 0, \"ontime\").otherwise(\"delayed\") ) \\\n                .drop(\"DELAY_LABELED\")\n\ndelay.show()\n\ntotal = delay.select(\"count\").collect()[0][0] + delay.select(\"count\").collect()[1][0]\n\nprint(\"Total Count: \" + str(total))\n\ndelay_r = delay.withColumn(\"PERCENTAGE\", (col(\"count\")/float(total)*100) )\ndelay_r.createOrReplaceTempView(\"delay_r\")\n\ndelay_r.show()","user":"anonymous","dateUpdated":"2018-12-30T18:45:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+\n| count| STATUS|\n+------+-------+\n|187216|delayed|\n|843390| ontime|\n+------+-------+\n\nTotal Count: 1030606\n+------+-------+-----------------+\n| count| STATUS|       PERCENTAGE|\n+------+-------+-----------------+\n|187216|delayed|18.16562294417071|\n|843390| ontime| 81.8343770558293|\n+------+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1546190694330_1224396295","id":"20180423-144358_1355204171","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:24+0000","dateFinished":"2018-12-30T18:45:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9943"},{"title":"EXPLORATORY ANALYSIS - Percentage of On-Time VS Delayed Flights","text":"%sql\n\nselect DELAY_LABELED, count(*) as count from train_df\n    group by DELAY_LABELED\n","user":"anonymous","dateUpdated":"2018-12-30T18:45:31+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":[{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"DELAY_LABELED","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"pickup_longitude","index":3,"aggr":"sum"},"yAxis":{"name":"pickup_latitude","index":2,"aggr":"sum"},"size":{"name":"fare_amount","index":9,"aggr":"sum"}},"setting":{"pieChart":{}},"commonSetting":{}},"helium":{}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DELAY_LABELED\tcount\n1\t187216\n0\t843390\n"}]},"apps":[],"jobName":"paragraph_1546190694330_815497412","id":"20170320-023510_703313108","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:31+0000","dateFinished":"2018-12-30T18:45:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9944"},{"title":"Compare Delays VS Non-Delays by Day of Week (1=Monday, 7=Sunday)","text":"%pyspark\n\ndelay_flights_count = train_df.filter( train_df.DELAY_LABELED == 1 ) \\\n                              .groupby( train_df.DAY_OF_WEEK ).count() \\\n                              .withColumnRenamed( \"count\", \"DELAY_COUNT\")\n\nnon_delay_flights_count = train_df.filter( train_df.DELAY_LABELED == 0 ) \\\n                              .groupby( train_df.DAY_OF_WEEK ).count() \\\n                              .withColumnRenamed( \"count\", \"NON_DELAY_COUNT\")\n\ndayofweek_count = delay_flights_count.join(non_delay_flights_count, delay_flights_count[\"DAY_OF_WEEK\"] == non_delay_flights_count[\"DAY_OF_WEEK\"] ) \\\n                                     .drop( non_delay_flights_count.DAY_OF_WEEK ) \\\n                                     .sort( col(\"DAY_OF_WEEK\") )\n\ndayofweek_count.createOrReplaceTempView(\"dayofweek_count\")\ndayofweek_count.show()","user":"anonymous","dateUpdated":"2018-12-30T18:45:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----------+---------------+\n|DELAY_COUNT|DAY_OF_WEEK|NON_DELAY_COUNT|\n+-----------+-----------+---------------+\n|      31396|          1|         120871|\n|      26323|          2|         120897|\n|      24874|          3|         124656|\n|      30381|          4|         127328|\n|      29230|          5|         127520|\n|      19393|          6|         103732|\n|      25619|          7|         118386|\n+-----------+-----------+---------------+\n\n"}]},"apps":[],"jobName":"paragraph_1546190694331_-1362381729","id":"20180423-150622_233344042","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:36+0000","dateFinished":"2018-12-30T18:45:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9945"},{"title":"Percentage of Delays by Day of Week (1=Monday, 7=Sunday)","text":"%sql\n\nselect DAY_OF_WEEK, ((DELAY_COUNT / (DELAY_COUNT + NON_DELAY_COUNT))*100) AS DELAY_PERCENT\n    from dayofweek_count\n    \n","user":"anonymous","dateUpdated":"2019-01-04T14:54:48+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"DAY_OF_WEEK","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"DELAY_PERCENT","index":1,"aggr":"avg"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DAY_OF_WEEK\tDELAY_PERCENT\n1\t20.61904417897509\n2\t17.8800434723543\n3\t16.634789005550726\n4\t19.26396083926726\n5\t18.647527910685806\n6\t15.750659898477156\n7\t17.790354501579806\n"}]},"apps":[],"jobName":"paragraph_1546190694331_-1148394533","id":"20180423-153606_25272067","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:45:54+0000","dateFinished":"2018-12-30T18:45:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9946"},{"title":"Percentage of Delays by Origin","text":"%sql\n\nselect ORIGIN, round((sum(DELAY_LABELED) / count(*))*100, 2) as delay_percentage\n    from train_df\n    group by ORIGIN\n    order by delay_percentage desc","user":"anonymous","dateUpdated":"2019-01-04T14:54:48+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"ORIGIN","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"delay_percentage","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ORIGIN\tdelay_percentage\nBQN\t33.56\nMTJ\t25.88\nORD\t25.34\nIAH\t24.54\nLBB\t24.32\nEWR\t23.43\nDEN\t23.35\nLGA\t23.18\nIAD\t23.05\nMIA\t22.74\nJFK\t21.88\nFAT\t21.74\nBOS\t21.53\nDFW\t21.39\nGUC\t20.95\nEGE\t20.94\nCLT\t20.68\nHDN\t20.56\nDCA\t19.91\nPHL\t19.75\nSFO\t19.68\nSTT\t19.41\nANC\t18.74\nLAX\t18.58\nSTX\t18.5\nPBI\t18.12\nGUM\t17.98\nMCO\t17.84\nCOS\t17.62\nDTW\t17.56\nFAI\t17.48\nBWI\t17.32\nPSP\t17.31\nBNA\t17.21\nOGG\t16.94\nMSY\t16.72\nRDU\t16.54\nLAS\t16.47\nALB\t16.44\nELP\t16.42\nSEA\t16.23\nSJU\t16.09\nTPA\t16.0\nSTL\t15.97\nDSM\t15.96\nITO\t15.87\nAUS\t15.79\nPHX\t15.75\nCRW\t15.51\nCMH\t15.51\nSMF\t15.15\nABQ\t15.06\nMFE\t15.05\nBDL\t15.03\nMKE\t15.01\nRIC\t14.95\nICT\t14.73\nCLE\t14.66\nMCI\t14.62\nPIT\t14.6\nGRB\t14.6\nJAC\t14.59\nAGS\t14.53\nMDW\t14.53\nHNL\t14.44\nOMA\t14.36\nONT\t14.31\nTUL\t14.31\nMSP\t14.19\nIND\t14.04\nSHV\t14.01\nMSN\t13.96\nSNA\t13.85\nMEM\t13.81\nRSW\t13.73\nATL\t13.72\nSAN\t13.67\nBUF\t13.63\nKOA\t13.5\nSAT\t13.49\nMDT\t13.4\nDAY\t13.38\nFLL\t13.24\nPVD\t13.23\nECP\t13.1\nOKC\t13.1\nSAV\t13.05\nPDX\t12.99\nSDF\t12.95\nROC\t12.83\nPWM\t12.82\nRNO\t12.65\nSRQ\t12.58\nJAX\t12.55\nSJC\t12.53\nSLC\t12.39\nPNS\t12.39\nBHM\t12.31\nHOU\t12.09\nAVL\t12.06\nDAL\t12.01\nTRI\t11.93\nBZN\t11.86\nTUS\t11.8\nLFT\t11.56\nFAR\t11.53\nGRR\t11.41\nLIT\t11.4\nMLB\t11.34\nDAB\t11.23\nORF\t11.17\nROA\t11.11\nDLH\t11.11\nLIH\t10.89\nCVG\t10.87\nGPT\t10.86\nABE\t10.73\nGSP\t10.58\nVPS\t10.54\nGEG\t10.43\nJAN\t10.3\nBTR\t10.23\nCHS\t10.16\nEVV\t10.16\nFSD\t9.94\nBOI\t9.9\nGNV\t9.78\nBIL\t9.67\nHSV\t9.67\nCHA\t9.64\nXNA\t9.57\nGSO\t9.49\nTVC\t9.46\nMYR\t9.18\nILM\t9.13\nSYR\t9.04\nTYS\t9.01\nEYW\t8.98\nLEX\t8.45\nFCA\t8.42\nCAK\t8.29\nTLH\t8.19\nCAE\t8.01\nATW\t7.96\nMHT\t7.83\nFNT\t7.71\nMOB\t7.28\nFAY\t7.17\nJNU\t6.9\nPHF\t6.17\nOAK\t5.75\nBGR\t5.45\nBTV\t5.26\nRAP\t5.26\nPSC\t4.89\nSGF\t4.69\nCHO\t4.49\nMSO\t4.27\nBIS\t1.95\nLAN\t0.0\nMOT\t0.0\nAVP\t0.0\n"}]},"apps":[],"jobName":"paragraph_1546190694331_400315593","id":"20180423-154247_471724541","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:46:04+0000","dateFinished":"2018-12-30T18:46:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9947"},{"title":"Display Descriptive Stats","text":"%pyspark\n\ntrain_df.describe(['day_of_month','day_of_week','dep_delay','arr_delay','cancelled','air_time','distance','delay_labeled']).show()\n","user":"anonymous","dateUpdated":"2018-12-30T18:46:08+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+------------------+------------------+------------------+---------+------------------+------------------+-------------------+\n|summary|     day_of_month|       day_of_week|         dep_delay|         arr_delay|cancelled|          air_time|          distance|      delay_labeled|\n+-------+-----------------+------------------+------------------+------------------+---------+------------------+------------------+-------------------+\n|  count|          1030606|           1030606|           1030606|           1030606|  1030606|           1030606|           1030606|            1030606|\n|   mean|15.39944071740316|3.9361967619051317|10.939452128165371|4.4964680974106495|      0.0|137.35455644543114|1027.7749382402199|0.18165622944170712|\n| stddev|8.730470469828356|1.9823334094478118| 41.68744996874924| 44.15147169489554|      0.0| 79.03324434313053| 667.7328895728122| 0.3855611339196745|\n|    min|                1|                 1|               -68|               -87|        0|                17|                74|                  0|\n|    max|               31|                 7|              1988|              1971|        0|               683|              4983|                  1|\n+-------+-----------------+------------------+------------------+------------------+---------+------------------+------------------+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1546190694331_-900030010","id":"20170320-095829_431145914","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:46:09+0000","dateFinished":"2018-12-30T18:46:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9948"},{"title":"Print out the most current (train_df) table","text":"%sql\n\nselect * from train_df limit 20","user":"anonymous","dateUpdated":"2018-12-30T18:46:14+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"YEAR":"string","MONTH":"string","DAY_OF_MONTH":"string","DAY_OF_WEEK":"string","CARRIER":"string","FL_NUM":"string","ORIGIN":"string","DEST":"string","DEP_TIME":"string","DEP_DELAY":"string","ARR_TIME":"string","ARR_DELAY":"string","CANCELLED":"string","CANCELLATION_CODE":"string","AIR_TIME":"string","DISTANCE":"string","WEEKEND":"string","DEP_HOUR":"string","DELAY_LABELED":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"YEAR\tMONTH\tDAY_OF_MONTH\tDAY_OF_WEEK\tCARRIER\tFL_NUM\tORIGIN\tDEST\tDEP_TIME\tDEP_DELAY\tARR_TIME\tARR_DELAY\tCANCELLED\tCANCELLATION_CODE\tAIR_TIME\tDISTANCE\tWEEKEND\tDEP_HOUR\tDELAY_LABELED\n2015\t1\t1\t4\tAA\t1\tJFK\tLAX\t855\t-5\t1237\t7\t0\tnull\t378\t2475\t0\t8\t0\n2015\t1\t2\t5\tAA\t1\tJFK\tLAX\t850\t-10\t1211\t-19\t0\tnull\t357\t2475\t1\t8\t0\n2015\t1\t3\t6\tAA\t1\tJFK\tLAX\t853\t-7\t1151\t-39\t0\tnull\t330\t2475\t1\t8\t0\n2015\t1\t4\t7\tAA\t1\tJFK\tLAX\t853\t-7\t1218\t-12\t0\tnull\t352\t2475\t1\t8\t0\n2015\t1\t5\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1222\t-8\t0\tnull\t338\t2475\t0\t8\t0\n2015\t1\t6\t2\tAA\t1\tJFK\tLAX\t856\t-4\t1300\t25\t0\tnull\t335\t2475\t0\t8\t1\n2015\t1\t7\t3\tAA\t1\tJFK\tLAX\t859\t-1\t1221\t-14\t0\tnull\t341\t2475\t0\t8\t0\n2015\t1\t8\t4\tAA\t1\tJFK\tLAX\t856\t-4\t1158\t-37\t0\tnull\t333\t2475\t0\t8\t0\n2015\t1\t9\t5\tAA\t1\tJFK\tLAX\t901\t1\t1241\t6\t0\tnull\t353\t2475\t1\t9\t0\n2015\t1\t10\t6\tAA\t1\tJFK\tLAX\t903\t3\t1235\t0\t0\tnull\t345\t2475\t1\t9\t0\n2015\t1\t11\t7\tAA\t1\tJFK\tLAX\t854\t-6\t1159\t-36\t0\tnull\t337\t2475\t1\t8\t0\n2015\t1\t12\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1230\t-5\t0\tnull\t354\t2475\t0\t8\t0\n2015\t1\t13\t2\tAA\t1\tJFK\tLAX\t854\t-6\t1155\t-40\t0\tnull\t336\t2475\t0\t8\t0\n2015\t1\t14\t3\tAA\t1\tJFK\tLAX\t856\t-4\t1126\t-69\t0\tnull\t302\t2475\t0\t8\t0\n2015\t1\t15\t4\tAA\t1\tJFK\tLAX\t852\t-8\t1231\t-4\t0\tnull\t320\t2475\t0\t8\t0\n2015\t1\t16\t5\tAA\t1\tJFK\tLAX\t900\t0\t1206\t-29\t0\tnull\t321\t2475\t1\t9\t0\n2015\t1\t17\t6\tAA\t1\tJFK\tLAX\t852\t-8\t1157\t-38\t0\tnull\t343\t2475\t1\t8\t0\n2015\t1\t18\t7\tAA\t1\tJFK\tLAX\t916\t16\t1236\t1\t0\tnull\t340\t2475\t1\t9\t0\n2015\t1\t19\t1\tAA\t1\tJFK\tLAX\t854\t-6\t1218\t-17\t0\tnull\t359\t2475\t0\t8\t0\n2015\t1\t20\t2\tAA\t1\tJFK\tLAX\t853\t-7\t1203\t-32\t0\tnull\t349\t2475\t0\t8\t0\n"}]},"apps":[],"jobName":"paragraph_1546190694332_1045169830","id":"20180423-155743_1963966507","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:46:14+0000","dateFinished":"2018-12-30T18:46:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9949"},{"title":"Train and Test DataFrames","text":"%pyspark\n\n# Process Training DataFrame\nmodel_train_df = train_df\n# Filter for certain Airports (based on airport code) for both \"Origin\" and \"Dest\" variables.\nmodel_train_df = model_train_df[model_train_df.ORIGIN.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\nmodel_train_df = model_train_df[model_train_df.DEST.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\n# Stratified Sampling\nmodel_train_df = model_train_df.sampleBy(\"delay_labeled\", fractions={0: 0.4, 1: 0.99}, seed=1111)\n\n# Process Test DataFrame (uncomment the line below for HDFS)\n#model_test_df = spark.read.load(\"hdfs:///tmp/airline_data/test_df.csv\", \"csv\", delimiter=\",\", inferSchema=True, header=True)\nmodel_test_df = spark.read.load(\"file:///airline_data/test_df.csv\", \"csv\", delimiter=\",\", inferSchema=True, header=True)\nmodel_test_df = model_test_df[model_test_df.ORIGIN.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\nmodel_test_df = model_test_df[model_test_df.DEST.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\nmodel_test_df = model_test_df.withColumn(\"WEEKEND\", when((model_test_df.DAY_OF_WEEK == 5) | (model_test_df.DAY_OF_WEEK == 6) | (model_test_df.DAY_OF_WEEK == 7), 1).otherwise(0))\nmodel_test_df = model_test_df.withColumn(\"DEP_HOUR\", (model_test_df.DEP_TIME/float(100)).cast('int') )\nmodel_test_df = model_test_df.withColumn(\"DELAY_LABELED\", when( (model_test_df.ARR_DELAY > 15), 1).otherwise(0))\nmodel_test_df = model_test_df.filter(model_test_df.CANCELLED == 0)\nmodel_test_df = model_test_df.filter( model_test_df.ARR_DELAY != \"NA\" )\nmodel_test_df = model_test_df.withColumn(\"ARR_DELAY\",     col(\"ARR_DELAY\").cast(\"int\")) \\\n                             .withColumn(\"DEP_DELAY\",     col(\"DEP_DELAY\").cast(\"int\")) \\\n                             .withColumn(\"AIR_TIME\",      col(\"AIR_TIME\").cast(\"int\"))  \\\n                             .withColumn(\"DAY_OF_WEEK\",   col(\"DAY_OF_WEEK\").cast(\"string\"))\n\n\nprint(\"Training Record Count:  \" + str(model_train_df.count()))\nprint(\"Testing Record Count:   \" + str(model_test_df.count()))\n","user":"anonymous","dateUpdated":"2018-12-30T18:47:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Training Record Count:  141119\nTesting Record Count:   192422\n"}]},"apps":[],"jobName":"paragraph_1546190694332_-1717487804","id":"20180423-160510_290046713","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:47:13+0000","dateFinished":"2018-12-30T18:47:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9950"},{"text":"%pyspark\n\nmodel_train_df.groupBy(\"delay_labeled\").count().show()","user":"anonymous","dateUpdated":"2018-12-30T18:47:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+\n|delay_labeled|count|\n+-------------+-----+\n|            1|54235|\n|            0|86884|\n+-------------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1546190694332_-1163155540","id":"20180424-132717_692421176","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:47:20+0000","dateFinished":"2018-12-30T18:47:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9951"},{"title":"Model Prep and Transformations","text":"%pyspark\n\n# Index string variables (using string indexer)\nsi1  = StringIndexer(inputCol=\"DAY_OF_WEEK\", outputCol=\"DAY_OF_WEEK_index\")\nsi2  = StringIndexer(inputCol=\"CARRIER\",     outputCol=\"CARRIER_index\")\nsi3  = StringIndexer(inputCol=\"ORIGIN\",      outputCol=\"ORIGIN_index\")\nsi4  = StringIndexer(inputCol=\"DEST\",        outputCol=\"DEST_index\")\nsi5  = StringIndexer(inputCol=\"DEP_HOUR\",    outputCol=\"DEP_HOUR_index\")\n\nohe1 = OneHotEncoder(inputCol=\"DAY_OF_WEEK_index\",  outputCol=\"DAY_OF_WEEK_ohe\")\nohe2 = OneHotEncoder(inputCol=\"CARRIER_index\",      outputCol=\"CARRIER_ohe\")\nohe3 = OneHotEncoder(inputCol=\"ORIGIN_index\",       outputCol=\"ORIGIN_ohe\")\nohe4 = OneHotEncoder(inputCol=\"DEST_index\",         outputCol=\"DEST_ohe\")\nohe5 = OneHotEncoder(inputCol=\"DEP_HOUR_index\",     outputCol=\"DEP_HOUR_ohe\")\n\ncol_target   =  'DELAY_LABELED'\ncol_features =  [\n                'DAY_OF_WEEK_index','CARRIER_index','ORIGIN_index','DEST_index','DEP_HOUR_index',\n                #'DAY_OF_WEEK_ohe','CARRIER_ohe','ORIGIN_ohe','DEST_ohe','DEP_HOUR_ohe',\n                'AIR_TIME','DISTANCE','WEEKEND'\n                ]\n\nva  = VectorAssembler(inputCols=col_features, outputCol=\"features\")\n\nrfc = RandomForestClassifier(featuresCol=\"features\", labelCol=col_target, predictionCol=\"prediction\", probabilityCol=\"probability\", numTrees=25, maxDepth=5, maxBins=32, seed=12345)\nglr = GeneralizedLinearRegression(featuresCol=\"features\", labelCol=col_target, predictionCol=\"prediction\", family=\"gaussian\", maxIter=20, regParam=0.3)\n\npipeline = Pipeline(stages=[si1,si2,si3,si4,si5,ohe1,ohe2,ohe3,ohe4,ohe5,va,rfc])\n","user":"anonymous","dateUpdated":"2018-12-30T18:47:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546190694332_-1464294128","id":"20180423-155728_1753192054","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:47:27+0000","dateFinished":"2018-12-30T18:47:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9952"},{"title":"Model Training (Completes in ~ 30 seconds)","text":"%pyspark\n\nmodel = pipeline.fit(model_train_df)\n","user":"anonymous","dateUpdated":"2018-12-30T18:47:38+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546190694333_-653390556","id":"20170320-105544_864298752","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:47:38+0000","dateFinished":"2018-12-30T18:47:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9953"},{"title":"Model Evaluation","text":"%pyspark\n\npredictions = model.transform(model_test_df)\npredictions.createOrReplaceTempView(\"predictions\")\n\n# Multiclass Evaluator\nmc_evaluator = MulticlassClassificationEvaluator(labelCol=col_target, predictionCol=\"prediction\", metricName=\"accuracy\")#f1|weightedPrecision|weightedRecall|accuracy\naccuracy     = mc_evaluator.evaluate(predictions)\nprint(\"Accuracy:       \" + str(accuracy))\n\n# Binary Evaluator\nbi_evaluator = BinaryClassificationEvaluator(labelCol=col_target, metricName='areaUnderROC')  # areaUnderROC | areaUnderPR\nareaunderroc = bi_evaluator.evaluate(predictions)\nprint(\"Area Under ROC: \" + str(areaunderroc))\n\n# Print True Positive VS False Positives\npredictions.groupBy('delay_labeled','prediction').count().show()\n\n# Print Feature Importance\nfeature_importance_vars = sorted([(col_features[i],feature) for i,feature in enumerate(model.stages[-1].featureImportances)], key=lambda x: x[1], reverse=True)\nprint('Feature Importances (descending):')\nfor f in feature_importance_vars:\n    print(f)\n","user":"anonymous","dateUpdated":"2018-12-30T18:47:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy:       0.8041544106183285\nArea Under ROC: 0.6446777688190487\n+-------------+----------+------+\n|delay_labeled|prediction| count|\n+-------------+----------+------+\n|            1|       0.0| 29409|\n|            0|       0.0|150344|\n|            1|       1.0|  4393|\n|            0|       1.0|  8276|\n+-------------+----------+------+\n\nFeature Importances (descending):\n('DEP_HOUR_index', 0.6526638757828156)\n('CARRIER_index', 0.1273949744574595)\n('ORIGIN_index', 0.0751295044446527)\n('DEST_index', 0.05091759855434483)\n('AIR_TIME', 0.03909514358693081)\n('DAY_OF_WEEK_index', 0.029632652943288713)\n('DISTANCE', 0.025063576927232722)\n('WEEKEND', 0.00010267330327539035)\n"}]},"apps":[],"jobName":"paragraph_1546190694333_-851711348","id":"20180423-161730_894316472","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:47:54+0000","dateFinished":"2018-12-30T18:48:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9954"},{"title":"Visualize Delays vs Non-Delays (actuals vs predictions)","text":"%sql\n\nselect delay_labeled, prediction, count(*) as counts\n    from predictions\n    group by delay_labeled, prediction","user":"anonymous","dateUpdated":"2019-01-04T14:54:49+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[{"name":"delay_labeled","index":0,"aggr":"sum"}],"values":[{"name":"counts","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delay_labeled\tprediction\tcounts\n1\t0.0\t29409\n0\t0.0\t150344\n1\t1.0\t4393\n0\t1.0\t8276\n"}]},"apps":[],"jobName":"paragraph_1546190694333_1932838841","id":"20180423-221313_139723671","dateCreated":"2018-12-30T17:24:54+0000","dateStarted":"2018-12-30T18:48:24+0000","dateFinished":"2018-12-30T18:48:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9955"},{"text":"","user":"anonymous","dateUpdated":"2018-12-30T18:48:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546190694333_602918830","id":"20180424-164738_1452890775","dateCreated":"2018-12-30T17:24:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9956"}],"name":"Flight Predictor - Python","id":"2E1EYMCTH","noteParams":{},"noteForms":{},"angularObjects":{"angular:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}