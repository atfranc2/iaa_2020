{"paragraphs":[{"title":"Spark Version","text":"spark.version","user":"anonymous","dateUpdated":"2018-12-30T19:53:38+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: String = 2.3.2\n"}]},"apps":[],"jobName":"paragraph_1546178097457_-503158531","id":"20180405-115412_795640954","dateCreated":"2018-12-30T13:54:57+0000","dateStarted":"2018-12-30T19:53:38+0000","dateFinished":"2018-12-30T19:53:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:28846"},{"title":"Python Version","text":"%pyspark\nimport sys\nsys.version","user":"anonymous","dateUpdated":"2018-12-30T19:53:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'3.7.0 (default, Jun 28 2018, 13:15:42) \\n[GCC 7.2.0]'\n"}]},"apps":[],"jobName":"paragraph_1546178218908_1880596082","id":"20181230-135658_379782832","dateCreated":"2018-12-30T13:56:58+0000","dateStarted":"2018-12-30T19:53:53+0000","dateFinished":"2018-12-30T19:53:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28847"},{"title":"Generate Spark Dataframe","text":"%pyspark\n\nheader = [\"id\", \"budget\", \"revenue\", \"runtime\", \"vote_average\", \"release_date\", \"year\", \"title\"]\n\nmovie_list = [\n    [19995,\t237000000,\t2787965087,\t162,\t7.2,\t\"2009-12-10\", 2009, \"Avatar\"],\n    [285,\t300000000,\t961000000,\t169,\t6.9,\t\"2007-05-19\", 2007, \"Pirates of the Caribbean: At World's End\"],\n    [206647,245000000,\t880674609,\t148,\t6.3,\t\"2015-10-26\", 2015, \"Spectre\"],\n    [49026,\t250000000,\t1084939099,\t165,\t7.6,\t\"2012-07-16\", 2012, \"The Dark Knight Rises\"],\n    [49529,\t260000000,\t284139100,\t132,\t6.1,\t\"2012-03-07\", 2012, \"John Carter\"],\n    [559,\t258000000,\t890871626,\t139,\t5.9,\t\"2007-05-01\", 2007, \"Spider-Man 3\"],\n    [38757,\t260000000,\t591794936,\t100,\t7.4,\t\"2010-11-24\", 2010, \"Tangled\"],\n    [99861,\t280000000,\t1405403694,\t141,\t7.3,\t\"2015-04-22\", 2015, \"Avengers: Age of Ultron\"],\n    [767,\t250000000,\t933959197,\t153,\t7.4,\t\"2009-07-07\", 2009, \"Harry Potter and the Half-Blood Prince\"],\n    [209112,250000000,\t873260194,\t151,\t5.7,\t\"2016-03-23\", 2016, \"Batman v Superman: Dawn of Justice\"],\n    [1452,\t270000000,\t391081192,\t154,\t5.4,\t\"2006-06-28\", 2006, \"Superman Returns\"]\n]\n\ndf = spark.createDataFrame(movie_list, header)\n\ndf.show(10,False)\n","user":"anonymous","dateUpdated":"2018-12-30T19:53:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+----------+-------+------------+------------+----+----------------------------------------+\n|id    |budget   |revenue   |runtime|vote_average|release_date|year|title                                   |\n+------+---------+----------+-------+------------+------------+----+----------------------------------------+\n|19995 |237000000|2787965087|162    |7.2         |2009-12-10  |2009|Avatar                                  |\n|285   |300000000|961000000 |169    |6.9         |2007-05-19  |2007|Pirates of the Caribbean: At World's End|\n|206647|245000000|880674609 |148    |6.3         |2015-10-26  |2015|Spectre                                 |\n|49026 |250000000|1084939099|165    |7.6         |2012-07-16  |2012|The Dark Knight Rises                   |\n|49529 |260000000|284139100 |132    |6.1         |2012-03-07  |2012|John Carter                             |\n|559   |258000000|890871626 |139    |5.9         |2007-05-01  |2007|Spider-Man 3                            |\n|38757 |260000000|591794936 |100    |7.4         |2010-11-24  |2010|Tangled                                 |\n|99861 |280000000|1405403694|141    |7.3         |2015-04-22  |2015|Avengers: Age of Ultron                 |\n|767   |250000000|933959197 |153    |7.4         |2009-07-07  |2009|Harry Potter and the Half-Blood Prince  |\n|209112|250000000|873260194 |151    |5.7         |2016-03-23  |2016|Batman v Superman: Dawn of Justice      |\n+------+---------+----------+-------+------------+------------+----+----------------------------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546178097464_1288939802","id":"20180405-115432_614754846","dateCreated":"2018-12-30T13:54:57+0000","dateStarted":"2018-12-30T19:53:57+0000","dateFinished":"2018-12-30T19:54:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28848"},{"title":"Descriptive Stats & Basic DF Info","text":"%pyspark\n\nprint(\"Describe Dataframe:\")\ndf.describe().show()\n\nprint(\"Total Records: {}\".format(df.count()))\n\nprint(\"\\nColumn Info:\")\ndf.dtypes","user":"anonymous","dateUpdated":"2018-12-30T19:54:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Describe Dataframe:\n+-------+-----------------+--------------------+--------------------+------------------+------------------+------------+------------------+--------------------+\n|summary|               id|              budget|             revenue|           runtime|      vote_average|release_date|              year|               title|\n+-------+-----------------+--------------------+--------------------+------------------+------------------+------------+------------------+--------------------+\n|  count|               11|                  11|                  11|                11|                11|          11|                11|                  11|\n|   mean|61453.63636363636|               2.6E8|1.0077353394545455E9|146.72727272727272| 6.654545454545455|        null|2010.7272727272727|                null|\n| stddev|78500.09727289862|1.7770762504743572E7|  6.68258258604608E8|19.152498056864065|0.7916610845098253|        null|3.5239440713754036|                null|\n|    min|              285|           237000000|           284139100|               100|               5.4|  2006-06-28|              2006|              Avatar|\n|    max|           209112|           300000000|          2787965087|               169|               7.6|  2016-03-23|              2016|The Dark Knight R...|\n+-------+-----------------+--------------------+--------------------+------------------+------------------+------------+------------------+--------------------+\n\nTotal Records: 11\n\nColumn Info:\n[('id', 'bigint'), ('budget', 'bigint'), ('revenue', 'bigint'), ('runtime', 'bigint'), ('vote_average', 'double'), ('release_date', 'string'), ('year', 'bigint'), ('title', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1546193482757_1693180800","id":"20181230-181122_1988789482","dateCreated":"2018-12-30T18:11:22+0000","dateStarted":"2018-12-30T19:54:04+0000","dateFinished":"2018-12-30T19:54:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28849"},{"title":"Spark Filtering","text":"%pyspark\n\ndf.filter(df.vote_average >= 7.0).show(10,False)","user":"anonymous","dateUpdated":"2018-12-30T19:54:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+---------+----------+-------+------------+------------+----+--------------------------------------+\n|id   |budget   |revenue   |runtime|vote_average|release_date|year|title                                 |\n+-----+---------+----------+-------+------------+------------+----+--------------------------------------+\n|19995|237000000|2787965087|162    |7.2         |2009-12-10  |2009|Avatar                                |\n|49026|250000000|1084939099|165    |7.6         |2012-07-16  |2012|The Dark Knight Rises                 |\n|38757|260000000|591794936 |100    |7.4         |2010-11-24  |2010|Tangled                               |\n|99861|280000000|1405403694|141    |7.3         |2015-04-22  |2015|Avengers: Age of Ultron               |\n|767  |250000000|933959197 |153    |7.4         |2009-07-07  |2009|Harry Potter and the Half-Blood Prince|\n+-----+---------+----------+-------+------------+------------+----+--------------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1546194635096_2118315713","id":"20181230-183035_202931985","dateCreated":"2018-12-30T18:30:35+0000","dateStarted":"2018-12-30T19:54:09+0000","dateFinished":"2018-12-30T19:54:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28850"},{"title":"Spark GroupBy","text":"%pyspark\n\nfrom pyspark.sql.functions import col\n\ndf.groupBy(df.year).agg({\"vote_average\": \"avg\", \"*\": \"count\"}) \\\n    .sort(col(\"avg(vote_average)\").desc()) \\\n    .show(10,False)","user":"anonymous","dateUpdated":"2018-12-30T19:56:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------------+--------+\n|year|avg(vote_average)|count(1)|\n+----+-----------------+--------+\n|2010|7.4              |1       |\n|2009|7.300000000000001|2       |\n|2012|6.85             |2       |\n|2015|6.8              |2       |\n|2007|6.4              |2       |\n|2016|5.7              |1       |\n|2006|5.4              |1       |\n+----+-----------------+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1546194651370_-779772802","id":"20181230-183051_909720466","dateCreated":"2018-12-30T18:30:51+0000","dateStarted":"2018-12-30T19:56:36+0000","dateFinished":"2018-12-30T19:56:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28851"},{"title":"Load data into Dataframe from file","text":"%pyspark\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\n\n############################################################################################################\n#\n#   Load Rawdata\n#   Source: https://www.kaggle.com/tmdb/tmdb-movie-metadata\n#\n############################################################################################################\n\nschema = StructType([                                           \\\n    StructField(\"budget\", IntegerType(), True),                 \\\n    StructField(\"genres\", StringType(), True),                  \\\n    StructField(\"homepage\", StringType(), True),                \\\n    StructField(\"id\", StringType(), True),                      \\\n    StructField(\"keywords\", StringType(), True),                \\\n    StructField(\"original_language\", StringType(), True),       \\\n    StructField(\"original_title\", StringType(), True),          \\\n    StructField(\"overview\", StringType(), True),                \\\n    StructField(\"popularity\", FloatType(), True),               \\\n    StructField(\"production_companies\", StringType(), True),    \\\n    StructField(\"production_countries\", StringType(), True),    \\\n    StructField(\"release_date\", StringType(), True),            \\\n    StructField(\"revenue\", LongType(), True),                   \\\n    StructField(\"runtime\", IntegerType(), True),                \\\n    StructField(\"spoken_languages\", StringType(), True),        \\\n    StructField(\"status\", StringType(), True),                  \\\n    StructField(\"tagline\", StringType(), True),                 \\\n    StructField(\"title\", StringType(), True),                   \\\n    StructField(\"vote_average\", FloatType(), True),             \\\n    StructField(\"vote_count\", IntegerType(), True)])\n\nmovie_df = spark.read.load('file:///data/tmdb_5000_movies.csv', \n    format=\"csv\", \n    header=True, \n    schema=schema, \n    inferSchema=False, \n    quote='\"', \n    escape='\"', \n    mode=\"DROPMALFORMED\")\n\nprint(\"Number of records in movie_df: \" + str(movie_df.count()))\n\nmovie_df.createOrReplaceTempView('movie_df_table')\n","user":"anonymous","dateUpdated":"2018-12-30T19:56:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Number of records in movie_df: 4800\n"}]},"apps":[],"jobName":"paragraph_1546190876135_-664264446","id":"20181230-172756_369647197","dateCreated":"2018-12-30T17:27:56+0000","dateStarted":"2018-12-30T19:56:40+0000","dateFinished":"2018-12-30T19:56:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28852"},{"title":"Query data using PySpark SQL","text":"%sql\n\nselect id,budget,title,revenue,runtime,vote_average,release_date from movie_df_table limit 25","user":"anonymous","dateUpdated":"2018-12-30T19:56:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","budget":"string","title":"string","revenue":"string","runtime":"string","vote_average":"string","release_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}],"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tbudget\ttitle\trevenue\truntime\tvote_average\trelease_date\n19995\t237000000\tAvatar\t2787965087\t162\t7.2\t2009-12-10\n285\t300000000\tPirates of the Caribbean: At World's End\t961000000\t169\t6.9\t2007-05-19\n206647\t245000000\tSpectre\t880674609\t148\t6.3\t2015-10-26\n49026\t250000000\tThe Dark Knight Rises\t1084939099\t165\t7.6\t2012-07-16\n49529\t260000000\tJohn Carter\t284139100\t132\t6.1\t2012-03-07\n559\t258000000\tSpider-Man 3\t890871626\t139\t5.9\t2007-05-01\n38757\t260000000\tTangled\t591794936\t100\t7.4\t2010-11-24\n99861\t280000000\tAvengers: Age of Ultron\t1405403694\t141\t7.3\t2015-04-22\n767\t250000000\tHarry Potter and the Half-Blood Prince\t933959197\t153\t7.4\t2009-07-07\n209112\t250000000\tBatman v Superman: Dawn of Justice\t873260194\t151\t5.7\t2016-03-23\n1452\t270000000\tSuperman Returns\t391081192\t154\t5.4\t2006-06-28\n10764\t200000000\tQuantum of Solace\t586090727\t106\t6.1\t2008-10-30\n58\t200000000\tPirates of the Caribbean: Dead Man's Chest\t1065659812\t151\t7.0\t2006-06-20\n57201\t255000000\tThe Lone Ranger\t89289910\t149\t5.9\t2013-07-03\n49521\t225000000\tMan of Steel\t662845518\t143\t6.5\t2013-06-12\n2454\t225000000\tThe Chronicles of Narnia: Prince Caspian\t419651413\t150\t6.3\t2008-05-15\n24428\t220000000\tThe Avengers\t1519557910\t143\t7.4\t2012-04-25\n1865\t380000000\tPirates of the Caribbean: On Stranger Tides\t1045713802\t136\t6.4\t2011-05-14\n41154\t225000000\tMen in Black 3\t624026776\t106\t6.2\t2012-05-23\n122917\t250000000\tThe Hobbit: The Battle of the Five Armies\t956019788\t144\t7.1\t2014-12-10\n1930\t215000000\tThe Amazing Spider-Man\t752215857\t136\t6.5\t2012-06-27\n20662\t200000000\tRobin Hood\t310669540\t140\t6.2\t2010-05-12\n57158\t250000000\tThe Hobbit: The Desolation of Smaug\t958400000\t161\t7.6\t2013-12-11\n2268\t180000000\tThe Golden Compass\t372234864\t113\t5.8\t2007-12-04\n254\t207000000\tKing Kong\t550000000\t187\t6.6\t2005-12-14\n"}]},"apps":[],"jobName":"paragraph_1546178097465_-427427109","id":"20180405-115744_153060313","dateCreated":"2018-12-30T13:54:57+0000","dateStarted":"2018-12-30T19:56:44+0000","dateFinished":"2018-12-30T19:56:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28853"},{"user":"anonymous","dateUpdated":"2018-12-30T13:54:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546178097466_-1535497089","id":"20180405-123344_2115651552","dateCreated":"2018-12-30T13:54:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28854"}],"name":"Getting Started - Python","id":"2DYXYTUAR","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}